<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Variational Inference in Sparse Gaussian Processes and Variational Auto-Encoders</title>
    <style>
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css"
        integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet"
        type="text/css">
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
    <link rel="stylesheet" href="blog_style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
            font-size: 14px;
            line-height: 1.6;
        }
    </style>
    <style>
        .task-list-item {
            list-style-type: none;
        }

        .task-list-item-checkbox {
            margin-left: -20px;
            vertical-align: middle;
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>

</head>

<body class="vscode-body vscode-light">
    <h1 id="variational-inference-in-sparse-gaussian-processes-and-variational-auto-encoders">Variational Inference in
        Sparse Gaussian Processes and Variational Auto-Encoders</h1>
    <p><em>A deep learning first explanation by <a href="https://joo.st">Joost van Amersfoort</a></em></p>
    <h2 id="introduction">Introduction</h2>
    <p>Until 2013, Gaussian Processes (GPs) were roughly as popular as deep learning, according to <a
            href="https://trends.google.com/trends/explore?date=all&amp;q=deep%20learning,gaussian%20process">Google
            Trends</a>.
        Since then deep learning has seen a 30x increase in interest, while interest in GPs remained unchanged (although
        the UK is 3x more interested relative to the US!).
        Despite the community not increasing as fast, there's been steady research happening with GPs.
        In this blog, I'll explain one of the main research advances in GPs from a deep learning first perspective by
        deriving it similarly to the Variational Auto-Encoder (VAE)!</p>
    <p>GPs come out-of-the-box with uncertainty, some interpretability, and rigorous
        mathematical foundations.
        So it's not surprising that they remain a topic of
        great interest to research! However compared to deep learning, GPs are more
        difficult to scale, both in terms of training data set size, and the
        dimensionality of the data itself. On both fronts the GP community is making
        progress, but for this blog I'll focus on one of the proposed solutions to
        scaling to large data set sizes: variational inference in GPs. I'll use notation
        from the deep learning literature and attempt to rederive a famous result in GPs
        using steps that resemble deriving the VAE objective. I'll also include as much
        intuition as possible and by doing this I hope to make the GP literature more
        accessible for those with only experience in deep learning.</p>
    <p>For the purpose of this blog, I assume that you have some familiarity with the
        <a href="https://arxiv.org/abs/1312.6114">Variational Auto-Encoder</a> and variational
        inference in general. A good reference to get up to speed with both those
        concepts is this
        <a href="https://jaan.io/what-is-variational-autoencoder-vae-tutorial/">blog</a> by Jaan
        Altosaar, specifically the section titled &quot;The probability model perspective&quot;.
        Familiarity with GPs is not necessary, but if you would like a gentle
        explanation with many beautiful visualisations then the <a
            href="https://distill.pub/2019/visual-exploration-gaussian-processes/">Distill article on
            GPs</a> is great.
    </p>
    <h2 id="variational-auto-encoders">Variational Auto encoders</h2>
    <p>Let's start by recalling the assumptions that underlie the VAE. Our first
        assumption is that there is a random variable <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>Z</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">Z</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span></span></span></span> from which it is possible to
        generate our data set <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>X</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">X</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07847em;">X</span></span></span></span>. Inversely, if we have a data
        point <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>x</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">x</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.43056em;vertical-align:0em;"></span><span
                        class="mord mathdefault">x</span></span></span></span>, we also want
        to be able find (&quot;infer&quot;) its corresponding <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>z</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">z</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.04398em;">z</span></span></span></span>. To make things interesting, we
        restrict <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>z</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">z</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.04398em;">z</span></span></span></span> such that it is lower dimensional
        than our data points and easy to
        sample from.</p>
    <p>It turns out that if we were given the <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>x</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">x</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.43056em;vertical-align:0em;"></span><span
                        class="mord mathdefault">x</span></span></span></span> and <span class="katex"><span
                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>z</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">z</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.04398em;">z</span></span></span></span> pairs, then it's
        straightforward to train a model to predict <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>x</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">x</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.43056em;vertical-align:0em;"></span><span
                        class="mord mathdefault">x</span></span></span></span> from <span class="katex"><span
                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>z</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">z</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.04398em;">z</span></span></span></span>, i.e. <span class="katex"><span
                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>p</mi>
                            <mo stretchy="false">(</mo>
                            <mi>x</mi>
                            <mi mathvariant="normal">∣</mi>
                            <mi>z</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">p(x|z)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span
                        class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord">∣</span><span
                        class="mord mathdefault" style="margin-right:0.04398em;">z</span><span
                        class="mclose">)</span></span></span></span>. However
        we only have our data set <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>X</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">X</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07847em;">X</span></span></span></span>, and we need to figure out how to
        structure <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>Z</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">Z</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span></span></span></span>,
        such that it becomes usable, i.e. <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>p</mi>
                            <mo stretchy="false">(</mo>
                            <mi>z</mi>
                            <mi mathvariant="normal">∣</mi>
                            <mi>x</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">p(z|x)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span
                        class="mopen">(</span><span class="mord mathdefault"
                        style="margin-right:0.04398em;">z</span><span class="mord">∣</span><span
                        class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span>, and
        afterwards we can model
        <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>p</mi>
                            <mo stretchy="false">(</mo>
                            <mi>x</mi>
                            <mi mathvariant="normal">∣</mi>
                            <mi>z</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">p(x|z)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span
                        class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord">∣</span><span
                        class="mord mathdefault" style="margin-right:0.04398em;">z</span><span
                        class="mclose">)</span></span></span></span>. Unfortunately, computing the true value of <span
            class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>p</mi>
                            <mo stretchy="false">(</mo>
                            <mi>z</mi>
                            <mi mathvariant="normal">∣</mi>
                            <mi>x</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">p(z|x)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span
                        class="mopen">(</span><span class="mord mathdefault"
                        style="margin-right:0.04398em;">z</span><span class="mord">∣</span><span
                        class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span> is
        intractable (it requires evaluating all possible values of <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>z</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">z</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.04398em;">z</span></span></span></span>!). Instead we
        will try to find a good approximate distribution, which we call q. We decide
        that q will be a Gaussian distribution parametrised by <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>θ</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">\theta</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.02778em;">θ</span></span></span></span>, which lends
        itself well for applying the <a href="https://arxiv.org/abs/1312.6114">reparametrisation
            trick</a> and also allows easy sampling of new
        data points (fun!).
    </p>
    <p><strong>The process of finding the best approximation q(z|x) to p(z|x) is called Variational Inference!</strong>
    </p>
    <p>We measure the difference between <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>p</mi>
                            <mo stretchy="false">(</mo>
                            <mi>z</mi>
                            <mi mathvariant="normal">∣</mi>
                            <mi>x</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">p(z|x)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span
                        class="mopen">(</span><span class="mord mathdefault"
                        style="margin-right:0.04398em;">z</span><span class="mord">∣</span><span
                        class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span> and <span
            class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>q</mi>
                            <mo stretchy="false">(</mo>
                            <mi>z</mi>
                            <mi mathvariant="normal">∣</mi>
                            <mi>x</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">q(z|x)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span
                        class="mord mathdefault" style="margin-right:0.04398em;">z</span><span
                        class="mord">∣</span><span class="mord mathdefault">x</span><span
                        class="mclose">)</span></span></span></span> using the <a
            href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence">KL
            divergence</a>
        and we are interested in finding the set of parameters <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>θ</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">\theta</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.02778em;">θ</span></span></span></span> that minimise
        it: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <msub>
                                <mo>
                                    <mi mathvariant="normal">argmin</mi>
                                    <mo>⁡</mo>
                                </mo>
                                <mi>θ</mi>
                            </msub>
                            <mi>K</mi>
                            <mi>L</mi>
                            <mo stretchy="false">(</mo>
                            <msub>
                                <mi>q</mi>
                                <mi>θ</mi>
                            </msub>
                            <mo stretchy="false">(</mo>
                            <mi>Z</mi>
                            <mi mathvariant="normal">∣</mi>
                            <mi>X</mi>
                            <mo stretchy="false">)</mo>
                            <mi mathvariant="normal">∣</mi>
                            <mi>p</mi>
                            <mo stretchy="false">(</mo>
                            <mi>Z</mi>
                            <mi mathvariant="normal">∣</mi>
                            <mi>X</mi>
                            <mo stretchy="false">)</mo>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">\operatorname{argmin}_\theta KL(q_\theta(Z|X)|p(Z|X))
                        </annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mop"><span
                                class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm"
                                style="margin-right:0.01389em;">g</span><span class="mord mathrm">m</span><span
                                class="mord mathrm">i</span><span class="mord mathrm">n</span></span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.24196799999999993em;"><span
                                            style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut"
                                                style="height:2.7em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathdefault mtight"
                                                    style="margin-right:0.02778em;">θ</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.24414em;"><span></span></span></span></span></span></span><span
                        class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">K</span><span class="mord mathdefault">L</span><span
                        class="mopen">(</span><span class="mord"><span class="mord mathdefault"
                            style="margin-right:0.03588em;">q</span><span class="msupsub"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.33610799999999996em;"><span
                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                class="pstrut" style="height:2.7em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathdefault mtight"
                                                    style="margin-right:0.02778em;">θ</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                        class="mopen">(</span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span><span class="mord">∣</span><span
                        class="mord mathdefault" style="margin-right:0.07847em;">X</span><span
                        class="mclose">)</span><span class="mord">∣</span><span class="mord mathdefault">p</span><span
                        class="mopen">(</span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span><span class="mord">∣</span><span
                        class="mord mathdefault" style="margin-right:0.07847em;">X</span><span
                        class="mclose">)</span><span class="mclose">)</span></span></span></span></p>
    <p>Rewriting the KL divergence we obtain:</p>
    <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em">
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow></mrow>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mi>K</mi>
                                                <mi>L</mi>
                                                <mo stretchy="false">(</mo>
                                                <msub>
                                                    <mi>q</mi>
                                                    <mi>θ</mi>
                                                </msub>
                                                <mo stretchy="false">(</mo>
                                                <mi>Z</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>X</mi>
                                                <mo stretchy="false">)</mo>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>Z</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>X</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow></mrow>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>=</mo>
                                                <msub>
                                                    <mo>∫</mo>
                                                    <mi>Z</mi>
                                                </msub>
                                                <msub>
                                                    <mi>q</mi>
                                                    <mi>θ</mi>
                                                </msub>
                                                <mo stretchy="false">(</mo>
                                                <mi>Z</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>X</mi>
                                                <mo stretchy="false">)</mo>
                                                <mi>log</mi>
                                                <mo>⁡</mo>
                                                <mfrac>
                                                    <mrow>
                                                        <msub>
                                                            <mi>q</mi>
                                                            <mi>θ</mi>
                                                        </msub>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>Z</mi>
                                                        <mi mathvariant="normal">∣</mi>
                                                        <mi>X</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mrow>
                                                        <mi>p</mi>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>Z</mi>
                                                        <mi mathvariant="normal">∣</mi>
                                                        <mi>X</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                </mfrac>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow></mrow>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>=</mo>
                                                <msub>
                                                    <mo>∫</mo>
                                                    <mi>Z</mi>
                                                </msub>
                                                <msub>
                                                    <mi>q</mi>
                                                    <mi>θ</mi>
                                                </msub>
                                                <mo stretchy="false">(</mo>
                                                <mi>Z</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>X</mi>
                                                <mo stretchy="false">)</mo>
                                                <mi>log</mi>
                                                <mo>⁡</mo>
                                                <mfrac>
                                                    <mrow>
                                                        <msub>
                                                            <mi>q</mi>
                                                            <mi>θ</mi>
                                                        </msub>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>Z</mi>
                                                        <mi mathvariant="normal">∣</mi>
                                                        <mi>X</mi>
                                                        <mo stretchy="false">)</mo>
                                                        <mi>p</mi>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>X</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mrow>
                                                        <mi>p</mi>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>Z</mi>
                                                        <mo separator="true">,</mo>
                                                        <mi>X</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                </mfrac>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow></mrow>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>=</mo>
                                                <msub>
                                                    <mo>∫</mo>
                                                    <mi>Z</mi>
                                                </msub>
                                                <msub>
                                                    <mi>q</mi>
                                                    <mi>θ</mi>
                                                </msub>
                                                <mo stretchy="false">(</mo>
                                                <mi>Z</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>X</mi>
                                                <mo stretchy="false">)</mo>
                                                <mrow>
                                                    <mo fence="true">[</mo>
                                                    <mi>log</mi>
                                                    <mo>⁡</mo>
                                                    <mfrac>
                                                        <mrow>
                                                            <msub>
                                                                <mi>q</mi>
                                                                <mi>θ</mi>
                                                            </msub>
                                                            <mo stretchy="false">(</mo>
                                                            <mi>Z</mi>
                                                            <mi mathvariant="normal">∣</mi>
                                                            <mi>X</mi>
                                                            <mo stretchy="false">)</mo>
                                                        </mrow>
                                                        <mrow>
                                                            <mi>p</mi>
                                                            <mo stretchy="false">(</mo>
                                                            <mi>Z</mi>
                                                            <mo separator="true">,</mo>
                                                            <mi>X</mi>
                                                            <mo stretchy="false">)</mo>
                                                        </mrow>
                                                    </mfrac>
                                                    <mo>+</mo>
                                                    <mi>log</mi>
                                                    <mo>⁡</mo>
                                                    <mi>p</mi>
                                                    <mo stretchy="false">(</mo>
                                                    <mi>X</mi>
                                                    <mo stretchy="false">)</mo>
                                                    <mo fence="true">]</mo>
                                                </mrow>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow></mrow>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>=</mo>
                                                <mi>log</mi>
                                                <mo>⁡</mo>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>X</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo>+</mo>
                                                <msub>
                                                    <mo>∫</mo>
                                                    <mi>z</mi>
                                                </msub>
                                                <msub>
                                                    <mi>q</mi>
                                                    <mi>θ</mi>
                                                </msub>
                                                <mo stretchy="false">(</mo>
                                                <mi>Z</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>X</mi>
                                                <mo stretchy="false">)</mo>
                                                <mi>log</mi>
                                                <mo>⁡</mo>
                                                <mfrac>
                                                    <mrow>
                                                        <msub>
                                                            <mi>q</mi>
                                                            <mi>θ</mi>
                                                        </msub>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>Z</mi>
                                                        <mi mathvariant="normal">∣</mi>
                                                        <mi>X</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mrow>
                                                        <mi>p</mi>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>Z</mi>
                                                        <mo separator="true">,</mo>
                                                        <mi>X</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                </mfrac>
                                                <mi mathvariant="normal">.</mi>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                            </mtable>
                            <annotation encoding="application/x-tex">\begin{aligned}
                                &amp; KL(q_\theta(Z|X)|p(Z|X)) \\
                                &amp;= \int_Z q_\theta(Z|X) \log \frac{q_\theta(Z|X)}{p(Z|X)} \\
                                &amp;= \int_Z q_\theta(Z|X) \log \frac{q_\theta(Z|X)p(X)}{p(Z,X)} \\
                                &amp;= \int_Z q_\theta(Z|X) \left [ \log \frac{q_\theta(Z|X)}{p(Z,X)} + \log p(X) \right
                                ]\\
                                &amp;= \log p(X) + \int_z q_\theta(Z|X) \log \frac{q_\theta(Z|X)}{p(Z,X)}. \\
                                \end{aligned}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:12.18903em;vertical-align:-5.844515em;"></span><span class="mord"><span
                                class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span
                                            class="vlist-r"><span class="vlist" style="height:6.344515em;"><span
                                                    style="top:-8.954515em;"><span class="pstrut"
                                                        style="height:3.45em;"></span><span
                                                        class="mord"></span></span><span
                                                    style="top:-6.867514999999999em;"><span class="pstrut"
                                                        style="height:3.45em;"></span><span
                                                        class="mord"></span></span><span
                                                    style="top:-4.204515000000001em;"><span class="pstrut"
                                                        style="height:3.45em;"></span><span
                                                        class="mord"></span></span><span
                                                    style="top:-1.5185150000000003em;"><span class="pstrut"
                                                        style="height:3.45em;"></span><span
                                                        class="mord"></span></span><span style="top:1.158515em;"><span
                                                        class="pstrut" style="height:3.45em;"></span><span
                                                        class="mord"></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:5.844515em;"><span></span></span></span></span></span><span
                                    class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:6.344515em;"><span
                                                    style="top:-8.954515em;"><span class="pstrut"
                                                        style="height:3.45em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">K</span><span
                                                            class="mord mathdefault">L</span><span
                                                            class="mopen">(</span><span class="mord"><span
                                                                class="mord mathdefault"
                                                                style="margin-right:0.03588em;">q</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mclose">)</span><span class="mord">∣</span><span
                                                            class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mclose">)</span><span
                                                            class="mclose">)</span></span></span><span
                                                    style="top:-6.867514999999999em;"><span class="pstrut"
                                                        style="height:3.45em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mop"><span class="mop op-symbol large-op"
                                                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:-0.433619em;"><span
                                                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.07153em;">Z</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mord mathdefault"
                                                                style="margin-right:0.03588em;">q</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mop">lo<span
                                                                style="margin-right:0.01389em;">g</span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mopen nulldelimiter"></span><span
                                                                class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:1.427em;"><span
                                                                                style="top:-2.314em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="mord"><span
                                                                                        class="mord mathdefault">p</span><span
                                                                                        class="mopen">(</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07153em;">Z</span><span
                                                                                        class="mord">∣</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07847em;">X</span><span
                                                                                        class="mclose">)</span></span></span><span
                                                                                style="top:-3.23em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="frac-line"
                                                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                                                style="top:-3.677em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="mord"><span
                                                                                        class="mord"><span
                                                                                            class="mord mathdefault"
                                                                                            style="margin-right:0.03588em;">q</span><span
                                                                                            class="msupsub"><span
                                                                                                class="vlist-t vlist-t2"><span
                                                                                                    class="vlist-r"><span
                                                                                                        class="vlist"
                                                                                                        style="height:0.33610799999999996em;"><span
                                                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                                                class="pstrut"
                                                                                                                style="height:2.7em;"></span><span
                                                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                                                    class="mord mathdefault mtight"
                                                                                                                    style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                                                        class="vlist-s">​</span></span><span
                                                                                                    class="vlist-r"><span
                                                                                                        class="vlist"
                                                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                                        class="mopen">(</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07153em;">Z</span><span
                                                                                        class="mord">∣</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07847em;">X</span><span
                                                                                        class="mclose">)</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.936em;"><span></span></span></span></span></span><span
                                                                class="mclose nulldelimiter"></span></span></span></span><span
                                                    style="top:-4.204515000000001em;"><span class="pstrut"
                                                        style="height:3.45em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mop"><span class="mop op-symbol large-op"
                                                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:-0.433619em;"><span
                                                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.07153em;">Z</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mord mathdefault"
                                                                style="margin-right:0.03588em;">q</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mop">lo<span
                                                                style="margin-right:0.01389em;">g</span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mopen nulldelimiter"></span><span
                                                                class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:1.427em;"><span
                                                                                style="top:-2.314em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="mord"><span
                                                                                        class="mord mathdefault">p</span><span
                                                                                        class="mopen">(</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07153em;">Z</span><span
                                                                                        class="mpunct">,</span><span
                                                                                        class="mspace"
                                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07847em;">X</span><span
                                                                                        class="mclose">)</span></span></span><span
                                                                                style="top:-3.23em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="frac-line"
                                                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                                                style="top:-3.677em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="mord"><span
                                                                                        class="mord"><span
                                                                                            class="mord mathdefault"
                                                                                            style="margin-right:0.03588em;">q</span><span
                                                                                            class="msupsub"><span
                                                                                                class="vlist-t vlist-t2"><span
                                                                                                    class="vlist-r"><span
                                                                                                        class="vlist"
                                                                                                        style="height:0.33610799999999996em;"><span
                                                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                                                class="pstrut"
                                                                                                                style="height:2.7em;"></span><span
                                                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                                                    class="mord mathdefault mtight"
                                                                                                                    style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                                                        class="vlist-s">​</span></span><span
                                                                                                    class="vlist-r"><span
                                                                                                        class="vlist"
                                                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                                        class="mopen">(</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07153em;">Z</span><span
                                                                                        class="mord">∣</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07847em;">X</span><span
                                                                                        class="mclose">)</span><span
                                                                                        class="mord mathdefault">p</span><span
                                                                                        class="mopen">(</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07847em;">X</span><span
                                                                                        class="mclose">)</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.936em;"><span></span></span></span></span></span><span
                                                                class="mclose nulldelimiter"></span></span></span></span><span
                                                    style="top:-1.5185150000000003em;"><span class="pstrut"
                                                        style="height:3.45em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mop"><span class="mop op-symbol large-op"
                                                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:-0.433619em;"><span
                                                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.07153em;">Z</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mord mathdefault"
                                                                style="margin-right:0.03588em;">q</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="minner"><span class="mopen delimcenter"
                                                                style="top:0em;"><span
                                                                    class="delimsizing size3">[</span></span><span
                                                                class="mop">lo<span
                                                                    style="margin-right:0.01389em;">g</span></span><span
                                                                class="mspace"
                                                                style="margin-right:0.16666666666666666em;"></span><span
                                                                class="mord"><span
                                                                    class="mopen nulldelimiter"></span><span
                                                                    class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:1.427em;"><span
                                                                                    style="top:-2.314em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3em;"></span><span
                                                                                        class="mord"><span
                                                                                            class="mord mathdefault">p</span><span
                                                                                            class="mopen">(</span><span
                                                                                            class="mord mathdefault"
                                                                                            style="margin-right:0.07153em;">Z</span><span
                                                                                            class="mpunct">,</span><span
                                                                                            class="mspace"
                                                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                                                            class="mord mathdefault"
                                                                                            style="margin-right:0.07847em;">X</span><span
                                                                                            class="mclose">)</span></span></span><span
                                                                                    style="top:-3.23em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3em;"></span><span
                                                                                        class="frac-line"
                                                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                                                    style="top:-3.677em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:3em;"></span><span
                                                                                        class="mord"><span
                                                                                            class="mord"><span
                                                                                                class="mord mathdefault"
                                                                                                style="margin-right:0.03588em;">q</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.33610799999999996em;"><span
                                                                                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.7em;"></span><span
                                                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                                                        class="mord mathdefault mtight"
                                                                                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                                                            class="vlist-s">​</span></span><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                                            class="mopen">(</span><span
                                                                                            class="mord mathdefault"
                                                                                            style="margin-right:0.07153em;">Z</span><span
                                                                                            class="mord">∣</span><span
                                                                                            class="mord mathdefault"
                                                                                            style="margin-right:0.07847em;">X</span><span
                                                                                            class="mclose">)</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.936em;"><span></span></span></span></span></span><span
                                                                    class="mclose nulldelimiter"></span></span><span
                                                                class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mbin">+</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mop">lo<span
                                                                    style="margin-right:0.01389em;">g</span></span><span
                                                                class="mspace"
                                                                style="margin-right:0.16666666666666666em;"></span><span
                                                                class="mord mathdefault">p</span><span
                                                                class="mopen">(</span><span class="mord mathdefault"
                                                                style="margin-right:0.07847em;">X</span><span
                                                                class="mclose">)</span><span class="mclose delimcenter"
                                                                style="top:0em;"><span
                                                                    class="delimsizing size3">]</span></span></span></span></span><span
                                                    style="top:1.158515em;"><span class="pstrut"
                                                        style="height:3.45em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mop">lo<span
                                                                style="margin-right:0.01389em;">g</span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">+</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mop"><span class="mop op-symbol large-op"
                                                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:-0.6105579999999999em;"><span
                                                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.04398em;">z</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mord mathdefault"
                                                                style="margin-right:0.03588em;">q</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mop">lo<span
                                                                style="margin-right:0.01389em;">g</span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mopen nulldelimiter"></span><span
                                                                class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:1.427em;"><span
                                                                                style="top:-2.314em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="mord"><span
                                                                                        class="mord mathdefault">p</span><span
                                                                                        class="mopen">(</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07153em;">Z</span><span
                                                                                        class="mpunct">,</span><span
                                                                                        class="mspace"
                                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07847em;">X</span><span
                                                                                        class="mclose">)</span></span></span><span
                                                                                style="top:-3.23em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="frac-line"
                                                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                                                style="top:-3.677em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="mord"><span
                                                                                        class="mord"><span
                                                                                            class="mord mathdefault"
                                                                                            style="margin-right:0.03588em;">q</span><span
                                                                                            class="msupsub"><span
                                                                                                class="vlist-t vlist-t2"><span
                                                                                                    class="vlist-r"><span
                                                                                                        class="vlist"
                                                                                                        style="height:0.33610799999999996em;"><span
                                                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                                                class="pstrut"
                                                                                                                style="height:2.7em;"></span><span
                                                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                                                    class="mord mathdefault mtight"
                                                                                                                    style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                                                        class="vlist-s">​</span></span><span
                                                                                                    class="vlist-r"><span
                                                                                                        class="vlist"
                                                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                                        class="mopen">(</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07153em;">Z</span><span
                                                                                        class="mord">∣</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07847em;">X</span><span
                                                                                        class="mclose">)</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.936em;"><span></span></span></span></span></span><span
                                                                class="mclose nulldelimiter"></span></span><span
                                                            class="mord">.</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:5.844515em;"><span></span></span></span></span></span></span></span></span></span></span></span>
    </p>
    <p>Since <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>p</mi>
                            <mo stretchy="false">(</mo>
                            <mi>X</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">p(X)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span
                        class="mopen">(</span><span class="mord mathdefault"
                        style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span> is
        independent of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>Z</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">Z</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span></span></span></span>, we can take it out of the
        integral and
        because <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>q</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">q</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault"
                        style="margin-right:0.03588em;">q</span></span></span></span> is a probability distribution
        (which integrate to 1), we simply have
        <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>p</mi>
                            <mo stretchy="false">(</mo>
                            <mi>X</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">p(X)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span
                        class="mopen">(</span><span class="mord mathdefault"
                        style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span> left.
        Also it doesn't depend on <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>θ</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">\theta</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.02778em;">θ</span></span></span></span>, so we can disregard it for this
        minimisation. We now take the integral, express it as an expectation and flip
        the sign (turning the argmin into and argmax) and obtain the evidence lower
        bound (ELBO):
    </p>
    <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em">
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow></mrow>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <msub>
                                                    <mo>
                                                        <mi mathvariant="normal">argmax</mi>
                                                        <mo>⁡</mo>
                                                    </mo>
                                                    <mi>θ</mi>
                                                </msub>
                                                <msub>
                                                    <mi mathvariant="double-struck">E</mi>
                                                    <mrow>
                                                        <mi>z</mi>
                                                        <mo>∼</mo>
                                                        <msub>
                                                            <mi>q</mi>
                                                            <mi>θ</mi>
                                                        </msub>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>Z</mi>
                                                        <mi mathvariant="normal">∣</mi>
                                                        <mi>X</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                </msub>
                                                <mo stretchy="false">[</mo>
                                                <mo>−</mo>
                                                <mi>log</mi>
                                                <mo>⁡</mo>
                                                <mfrac>
                                                    <mrow>
                                                        <msub>
                                                            <mi>q</mi>
                                                            <mi>θ</mi>
                                                        </msub>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>Z</mi>
                                                        <mi mathvariant="normal">∣</mi>
                                                        <mi>X</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mrow>
                                                        <mi>p</mi>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>Z</mi>
                                                        <mo separator="true">,</mo>
                                                        <mi>X</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                </mfrac>
                                                <mo stretchy="false">]</mo>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow></mrow>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>=</mo>
                                                <msub>
                                                    <mo>
                                                        <mi mathvariant="normal">argmax</mi>
                                                        <mo>⁡</mo>
                                                    </mo>
                                                    <mi>θ</mi>
                                                </msub>
                                                <msub>
                                                    <mi mathvariant="double-struck">E</mi>
                                                    <mrow>
                                                        <mi>z</mi>
                                                        <mo>∼</mo>
                                                        <msub>
                                                            <mi>q</mi>
                                                            <mi>θ</mi>
                                                        </msub>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>Z</mi>
                                                        <mi mathvariant="normal">∣</mi>
                                                        <mi>X</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                </msub>
                                                <mo stretchy="false">[</mo>
                                                <mo>−</mo>
                                                <mi>log</mi>
                                                <mo>⁡</mo>
                                                <msub>
                                                    <mi>q</mi>
                                                    <mi>θ</mi>
                                                </msub>
                                                <mo stretchy="false">(</mo>
                                                <mi>Z</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>X</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo>−</mo>
                                                <mi>log</mi>
                                                <mo>⁡</mo>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>X</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>Z</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo>+</mo>
                                                <mi>log</mi>
                                                <mo>⁡</mo>
                                                <mo stretchy="false">(</mo>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>Z</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo stretchy="false">)</mo>
                                                <mo stretchy="false">]</mo>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow></mrow>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>=</mo>
                                                <msub>
                                                    <mo>
                                                        <mi mathvariant="normal">argmax</mi>
                                                        <mo>⁡</mo>
                                                    </mo>
                                                    <mi>θ</mi>
                                                </msub>
                                                <msub>
                                                    <mi mathvariant="double-struck">E</mi>
                                                    <mrow>
                                                        <mi>z</mi>
                                                        <mo>∼</mo>
                                                        <msub>
                                                            <mi>q</mi>
                                                            <mi>θ</mi>
                                                        </msub>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>Z</mi>
                                                        <mi mathvariant="normal">∣</mi>
                                                        <mi>X</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                </msub>
                                                <mo stretchy="false">[</mo>
                                                <mi>log</mi>
                                                <mo>⁡</mo>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>X</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>Z</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo stretchy="false">]</mo>
                                                <mo>−</mo>
                                                <mi>K</mi>
                                                <mi>L</mi>
                                                <mo stretchy="false">[</mo>
                                                <msub>
                                                    <mi>q</mi>
                                                    <mi>θ</mi>
                                                </msub>
                                                <mo stretchy="false">(</mo>
                                                <mi>Z</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>X</mi>
                                                <mo stretchy="false">)</mo>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>Z</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo stretchy="false">]</mo>
                                                <mi mathvariant="normal">.</mi>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                            </mtable>
                            <annotation encoding="application/x-tex">\begin{aligned}
                                &amp;\operatorname{argmax}_\theta \mathbb{E}_{z \sim q_\theta(Z|X)}[- \log
                                \frac{q_\theta(Z|X)}{p(Z,X)}] \\
                                &amp;= \operatorname{argmax}_\theta \mathbb{E}_{z \sim q_\theta(Z|X)}[- \log
                                q_\theta(Z|X) - \log p(X|Z) + \log(p(Z))] \\
                                &amp;= \operatorname{argmax}_\theta \mathbb{E}_{z \sim q_\theta(Z|X)}[\log p(X|Z)] -
                                KL[q_\theta(Z|X) || (p(Z)]. \\
                                \end{aligned}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:5.663em;vertical-align:-2.5815em;"></span><span class="mord"><span
                                class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span
                                            class="vlist-r"><span class="vlist" style="height:3.0815em;"><span
                                                    style="top:-5.0815em;"><span class="pstrut"
                                                        style="height:3.427em;"></span><span
                                                        class="mord"></span></span><span style="top:-3.0055em;"><span
                                                        class="pstrut" style="height:3.427em;"></span><span
                                                        class="mord"></span></span><span style="top:-1.5055em;"><span
                                                        class="pstrut" style="height:3.427em;"></span><span
                                                        class="mord"></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:2.5815em;"><span></span></span></span></span></span><span
                                    class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:3.0815em;"><span
                                                    style="top:-5.0815em;"><span class="pstrut"
                                                        style="height:3.427em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mop"><span class="mop"><span
                                                                    class="mord mathrm">a</span><span
                                                                    class="mord mathrm">r</span><span
                                                                    class="mord mathrm"
                                                                    style="margin-right:0.01389em;">g</span><span
                                                                    class="mord mathrm">m</span><span
                                                                    class="mord mathrm">a</span><span
                                                                    class="mord mathrm">x</span></span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.24196799999999993em;"><span
                                                                                style="top:-2.4558600000000004em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.24414em;"><span></span></span></span></span></span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mord"><span
                                                                    class="mord mathbb">E</span></span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.34480000000000005em;"><span
                                                                                style="top:-2.5198em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathdefault mtight"
                                                                                            style="margin-right:0.04398em;">z</span><span
                                                                                            class="mrel mtight">∼</span><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathdefault mtight"
                                                                                                style="margin-right:0.03588em;">q</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.3448em;"><span
                                                                                                                style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.5em;"></span><span
                                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                                        class="mord mathdefault mtight"
                                                                                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                                                            class="vlist-s">​</span></span><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span
                                                                                            class="mopen mtight">(</span><span
                                                                                            class="mord mathdefault mtight"
                                                                                            style="margin-right:0.07153em;">Z</span><span
                                                                                            class="mord mtight">∣</span><span
                                                                                            class="mord mathdefault mtight"
                                                                                            style="margin-right:0.07847em;">X</span><span
                                                                                            class="mclose mtight">)</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span
                                                            class="mopen">[</span><span class="mord">−</span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mop">lo<span
                                                                style="margin-right:0.01389em;">g</span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mopen nulldelimiter"></span><span
                                                                class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:1.427em;"><span
                                                                                style="top:-2.314em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="mord"><span
                                                                                        class="mord mathdefault">p</span><span
                                                                                        class="mopen">(</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07153em;">Z</span><span
                                                                                        class="mpunct">,</span><span
                                                                                        class="mspace"
                                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07847em;">X</span><span
                                                                                        class="mclose">)</span></span></span><span
                                                                                style="top:-3.23em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="frac-line"
                                                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                                                style="top:-3.677em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="mord"><span
                                                                                        class="mord"><span
                                                                                            class="mord mathdefault"
                                                                                            style="margin-right:0.03588em;">q</span><span
                                                                                            class="msupsub"><span
                                                                                                class="vlist-t vlist-t2"><span
                                                                                                    class="vlist-r"><span
                                                                                                        class="vlist"
                                                                                                        style="height:0.33610799999999996em;"><span
                                                                                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                                                class="pstrut"
                                                                                                                style="height:2.7em;"></span><span
                                                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                                                    class="mord mathdefault mtight"
                                                                                                                    style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                                                        class="vlist-s">​</span></span><span
                                                                                                    class="vlist-r"><span
                                                                                                        class="vlist"
                                                                                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                                        class="mopen">(</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07153em;">Z</span><span
                                                                                        class="mord">∣</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.07847em;">X</span><span
                                                                                        class="mclose">)</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.936em;"><span></span></span></span></span></span><span
                                                                class="mclose nulldelimiter"></span></span><span
                                                            class="mclose">]</span></span></span><span
                                                    style="top:-3.0055em;"><span class="pstrut"
                                                        style="height:3.427em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mop"><span class="mop"><span
                                                                    class="mord mathrm">a</span><span
                                                                    class="mord mathrm">r</span><span
                                                                    class="mord mathrm"
                                                                    style="margin-right:0.01389em;">g</span><span
                                                                    class="mord mathrm">m</span><span
                                                                    class="mord mathrm">a</span><span
                                                                    class="mord mathrm">x</span></span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.24196799999999993em;"><span
                                                                                style="top:-2.4558600000000004em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.24414em;"><span></span></span></span></span></span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mord"><span
                                                                    class="mord mathbb">E</span></span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.34480000000000005em;"><span
                                                                                style="top:-2.5198em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathdefault mtight"
                                                                                            style="margin-right:0.04398em;">z</span><span
                                                                                            class="mrel mtight">∼</span><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathdefault mtight"
                                                                                                style="margin-right:0.03588em;">q</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.3448em;"><span
                                                                                                                style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.5em;"></span><span
                                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                                        class="mord mathdefault mtight"
                                                                                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                                                            class="vlist-s">​</span></span><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span
                                                                                            class="mopen mtight">(</span><span
                                                                                            class="mord mathdefault mtight"
                                                                                            style="margin-right:0.07153em;">Z</span><span
                                                                                            class="mord mtight">∣</span><span
                                                                                            class="mord mathdefault mtight"
                                                                                            style="margin-right:0.07847em;">X</span><span
                                                                                            class="mclose mtight">)</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span
                                                            class="mopen">[</span><span class="mord">−</span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mop">lo<span
                                                                style="margin-right:0.01389em;">g</span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mord mathdefault"
                                                                style="margin-right:0.03588em;">q</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">−</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mop">lo<span
                                                                style="margin-right:0.01389em;">g</span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">+</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mop">lo<span
                                                                style="margin-right:0.01389em;">g</span></span><span
                                                            class="mopen">(</span><span
                                                            class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mclose">)</span><span class="mclose">)</span><span
                                                            class="mclose">]</span></span></span><span
                                                    style="top:-1.5055em;"><span class="pstrut"
                                                        style="height:3.427em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mop"><span class="mop"><span
                                                                    class="mord mathrm">a</span><span
                                                                    class="mord mathrm">r</span><span
                                                                    class="mord mathrm"
                                                                    style="margin-right:0.01389em;">g</span><span
                                                                    class="mord mathrm">m</span><span
                                                                    class="mord mathrm">a</span><span
                                                                    class="mord mathrm">x</span></span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.24196799999999993em;"><span
                                                                                style="top:-2.4558600000000004em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.24414em;"><span></span></span></span></span></span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mord"><span
                                                                    class="mord mathbb">E</span></span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.34480000000000005em;"><span
                                                                                style="top:-2.5198em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathdefault mtight"
                                                                                            style="margin-right:0.04398em;">z</span><span
                                                                                            class="mrel mtight">∼</span><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mathdefault mtight"
                                                                                                style="margin-right:0.03588em;">q</span><span
                                                                                                class="msupsub"><span
                                                                                                    class="vlist-t vlist-t2"><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.3448em;"><span
                                                                                                                style="top:-2.3487714285714287em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span
                                                                                                                    class="pstrut"
                                                                                                                    style="height:2.5em;"></span><span
                                                                                                                    class="sizing reset-size3 size1 mtight"><span
                                                                                                                        class="mord mathdefault mtight"
                                                                                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                                                            class="vlist-s">​</span></span><span
                                                                                                        class="vlist-r"><span
                                                                                                            class="vlist"
                                                                                                            style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span
                                                                                            class="mopen mtight">(</span><span
                                                                                            class="mord mathdefault mtight"
                                                                                            style="margin-right:0.07153em;">Z</span><span
                                                                                            class="mord mtight">∣</span><span
                                                                                            class="mord mathdefault mtight"
                                                                                            style="margin-right:0.07847em;">X</span><span
                                                                                            class="mclose mtight">)</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span
                                                            class="mopen">[</span><span class="mop">lo<span
                                                                style="margin-right:0.01389em;">g</span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mclose">)</span><span class="mclose">]</span><span
                                                            class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">−</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">K</span><span
                                                            class="mord mathdefault">L</span><span
                                                            class="mopen">[</span><span class="mord"><span
                                                                class="mord mathdefault"
                                                                style="margin-right:0.03588em;">q</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.33610799999999996em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mclose">)</span><span class="mord">∣</span><span
                                                            class="mord">∣</span><span class="mopen">(</span><span
                                                            class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mclose">)</span><span class="mclose">]</span><span
                                                            class="mord">.</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:2.5815em;"><span></span></span></span></span></span></span></span></span></span></span></span>
    </p>
    <p>The last formula is one we can work with! <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>log</mi>
                            <mo>⁡</mo>
                            <mi>p</mi>
                            <mo stretchy="false">(</mo>
                            <mi>X</mi>
                            <mi mathvariant="normal">∣</mi>
                            <mi>Z</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">\log p(X|Z)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span
                            style="margin-right:0.01389em;">g</span></span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span
                        class="mopen">(</span><span class="mord mathdefault"
                        style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span
                        class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span
                        class="mclose">)</span></span></span></span> is the distribution we
        are interested in and we will also model it using a neural network, but with
        parameters <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>ϕ</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">\phi</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                        class="mord mathdefault">ϕ</span></span></span></span>. We choose <span class="katex"><span
                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>p</mi>
                            <mo stretchy="false">(</mo>
                            <mi>Z</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">p(Z)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span
                        class="mopen">(</span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span><span class="mclose">)</span></span></span></span> to be
        <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>N</mi>
                            <mo stretchy="false">(</mo>
                            <mn>0</mn>
                            <mo separator="true">,</mo>
                            <mi>I</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">N(0,I)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span
                        class="mord">0</span><span class="mpunct">,</span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07847em;">I</span><span class="mclose">)</span></span></span></span>,
        which makes the KL with <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>q</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">q</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault"
                        style="margin-right:0.03588em;">q</span></span></span></span>
        easy to compute. The only problem we have left is how to compute the expectation
        over <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>Z</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">Z</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span></span></span></span>!
    </p>
    <h3 id="reparametrisation-trick">Reparametrisation trick</h3>
    <p>To evaluate the gradient of the expectation, we would like to use samples of
        <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>q</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">q</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault"
                        style="margin-right:0.03588em;">q</span></span></span></span>. However, sampling from <span
            class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>q</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">q</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault"
                        style="margin-right:0.03588em;">q</span></span></span></span> is not a differentiable operation
        and won't
        allow us to backpropagate back to <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>q</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">q</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault"
                        style="margin-right:0.03588em;">q</span></span></span></span>. The key insight from the
        reparametrisation trick (introduced concurrently by <a href="https://arxiv.org/abs/1312.6114">Kingma et
            al.</a>, <a href="https://arxiv.org/abs/1401.4082">Rezende et
            al.</a>, and <a href="http://proceedings.mlr.press/v32/titsias14.pdf">Titsias et
            al.</a>) is that we can instead
        sample from a standard Gaussian <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>N</mi>
                            <mo stretchy="false">(</mo>
                            <mn>0</mn>
                            <mo separator="true">,</mo>
                            <mn>1</mn>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">N(0,1)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span
                        class="mord">0</span><span class="mpunct">,</span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span
                        class="mclose">)</span></span></span></span> and transform its samples in a
        deterministic way such that are samples from q:
    </p>
    <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi>Z</mi>
                                <mo>=</mo>
                                <mi>g</mi>
                                <mo stretchy="false">(</mo>
                                <mi>ϵ</mi>
                                <mo stretchy="false">)</mo>
                                <mo>=</mo>
                                <mi>μ</mi>
                                <mo>+</mo>
                                <mi>σ</mi>
                                <mo>⋅</mo>
                                <mi>ϵ</mi>
                                <mo separator="true">,</mo>
                                <mtext> and </mtext>
                                <mi>ϵ</mi>
                                <mo>∼</mo>
                                <mi>N</mi>
                                <mo stretchy="false">(</mo>
                                <mn>0</mn>
                                <mo separator="true">,</mo>
                                <mi>I</mi>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">Z = g(\epsilon) = \mu + \sigma \cdot \epsilon,
                                \text{ and } \epsilon \sim N(0,I)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                            style="margin-right:0.07153em;">Z</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord mathdefault" style="margin-right:0.03588em;">g</span><span
                            class="mopen">(</span><span class="mord mathdefault">ϵ</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span
                            class="mord mathdefault">μ</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span
                            class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span
                            class="mord mathdefault">ϵ</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord text"><span
                                class="mord"> and </span></span><span class="mord mathdefault">ϵ</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                            class="mrel">∼</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord mathdefault" style="margin-right:0.10903em;">N</span><span
                            class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord mathdefault" style="margin-right:0.07847em;">I</span><span
                            class="mclose">)</span></span></span></span></span></p>
    <p>With <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>μ</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">\mu</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.625em;vertical-align:-0.19444em;"></span><span
                        class="mord mathdefault">μ</span></span></span></span> and <span class="katex"><span
                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>σ</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">\sigma</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.03588em;">σ</span></span></span></span> being outputs of the neural
        network <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <msub>
                                <mi>q</mi>
                                <mi>θ</mi>
                            </msub>
                            <mo stretchy="false">(</mo>
                            <mi>z</mi>
                            <mi mathvariant="normal">∣</mi>
                            <mi>x</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">q_\theta(z|x)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span
                            class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.33610799999999996em;"><span
                                            style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                class="pstrut" style="height:2.7em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathdefault mtight"
                                                    style="margin-right:0.02778em;">θ</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                        class="mopen">(</span><span class="mord mathdefault"
                        style="margin-right:0.04398em;">z</span><span class="mord">∣</span><span
                        class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span>.
        If we plug this into the previous equation, we obtain:</p>
    <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <msub>
                                    <mo>
                                        <mi mathvariant="normal">argmax</mi>
                                        <mo>⁡</mo>
                                    </mo>
                                    <mi>θ</mi>
                                </msub>
                                <msub>
                                    <mi mathvariant="double-struck">E</mi>
                                    <mrow>
                                        <mi>ϵ</mi>
                                        <mo>∼</mo>
                                        <mi>N</mi>
                                        <mo stretchy="false">(</mo>
                                        <mn>0</mn>
                                        <mo separator="true">,</mo>
                                        <mn>1</mn>
                                        <mo stretchy="false">)</mo>
                                    </mrow>
                                </msub>
                                <mo stretchy="false">[</mo>
                                <mi>log</mi>
                                <mo>⁡</mo>
                                <msub>
                                    <mi>p</mi>
                                    <mi>ϕ</mi>
                                </msub>
                                <mo stretchy="false">(</mo>
                                <mi>X</mi>
                                <mi mathvariant="normal">∣</mi>
                                <mi>g</mi>
                                <mo stretchy="false">(</mo>
                                <mi>ϵ</mi>
                                <mo stretchy="false">)</mo>
                                <mo stretchy="false">)</mo>
                                <mo stretchy="false">]</mo>
                                <mo>−</mo>
                                <mi>K</mi>
                                <mi>L</mi>
                                <mo stretchy="false">[</mo>
                                <msub>
                                    <mi>q</mi>
                                    <mi>θ</mi>
                                </msub>
                                <mo stretchy="false">(</mo>
                                <mi>g</mi>
                                <mo stretchy="false">(</mo>
                                <mi>ϵ</mi>
                                <mo stretchy="false">)</mo>
                                <mi mathvariant="normal">∣</mi>
                                <mi>X</mi>
                                <mo stretchy="false">)</mo>
                                <mi mathvariant="normal">∣</mi>
                                <mi mathvariant="normal">∣</mi>
                                <mi>p</mi>
                                <mo stretchy="false">(</mo>
                                <mi>Z</mi>
                                <mo stretchy="false">)</mo>
                                <mo stretchy="false">]</mo>
                                <mi mathvariant="normal">.</mi>
                            </mrow>
                            <annotation encoding="application/x-tex">\operatorname{argmax}_\theta \mathbb{E}_{\epsilon
                                \sim N(0,1)}[\log p_\phi(X|g(\epsilon))] -
                                KL[q_\theta(g(\epsilon)|X) || p(Z)].
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="mop"><span
                                class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span
                                    class="mord mathrm" style="margin-right:0.01389em;">g</span><span
                                    class="mord mathrm">m</span><span class="mord mathrm">a</span><span
                                    class="mord mathrm">x</span></span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.24196799999999993em;"><span
                                                style="top:-2.4558600000000004em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathdefault mtight"
                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.24414em;"><span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.34480000000000005em;"><span
                                                style="top:-2.5198em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mathdefault mtight">ϵ</span><span
                                                            class="mrel mtight">∼</span><span
                                                            class="mord mathdefault mtight"
                                                            style="margin-right:0.10903em;">N</span><span
                                                            class="mopen mtight">(</span><span
                                                            class="mord mtight">0</span><span
                                                            class="mpunct mtight">,</span><span
                                                            class="mord mtight">1</span><span
                                                            class="mclose mtight">)</span></span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span
                            class="mopen">[</span><span class="mop">lo<span
                                style="margin-right:0.01389em;">g</span></span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathdefault">p</span><span class="msupsub"><span
                                    class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.3361079999999999em;"><span
                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathdefault mtight">ϕ</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.286108em;"><span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathdefault"
                            style="margin-right:0.07847em;">X</span><span class="mord">∣</span><span
                            class="mord mathdefault" style="margin-right:0.03588em;">g</span><span
                            class="mopen">(</span><span class="mord mathdefault">ϵ</span><span
                            class="mclose">)</span><span class="mclose">)</span><span class="mclose">]</span><span
                            class="mspace" style="margin-right:0.2222222222222222em;"></span><span
                            class="mbin">−</span><span class="mspace"
                            style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                            class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord mathdefault" style="margin-right:0.07153em;">K</span><span
                            class="mord mathdefault">L</span><span class="mopen">[</span><span class="mord"><span
                                class="mord mathdefault" style="margin-right:0.03588em;">q</span><span
                                class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                            style="height:0.33610799999999996em;"><span
                                                style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                    class="pstrut" style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mathdefault mtight"
                                                        style="margin-right:0.02778em;">θ</span></span></span></span><span
                                            class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                            class="mopen">(</span><span class="mord mathdefault"
                            style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span
                            class="mord mathdefault">ϵ</span><span class="mclose">)</span><span
                            class="mord">∣</span><span class="mord mathdefault"
                            style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span
                            class="mord">∣</span><span class="mord">∣</span><span class="mord mathdefault">p</span><span
                            class="mopen">(</span><span class="mord mathdefault"
                            style="margin-right:0.07153em;">Z</span><span class="mclose">)</span><span
                            class="mclose">]</span><span class="mord">.</span></span></span></span></span></p>
    <p>This equation is fully differentiable, so we can optimise it using backpropagation!
        A simple implementation of a model based on this equation can be found in the PyTorch example of the <a
            href="https://github.com/pytorch/examples/tree/master/vae">VAE</a>.
        With this result in hand, we will go look at the situation in GPs.</p>
    <h2 id="gaussian-processes">Gaussian Processes</h2>
    <p>We start by looking at the definition of what is sometimes called the &quot;full&quot;
        Gaussian process and continue with the more practical sparse Gaussian process.</p>
    <h3 id="definition">Definition</h3>
    <p>A Gaussian process is defined by a prior mean and covariance function, respectively
        <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>M</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">M</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.10903em;">M</span></span></span></span> and <span class="katex"><span
                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>K</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">K</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">K</span></span></span></span>, of the data set <span
            class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>X</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">X</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07847em;">X</span></span></span></span>:
    </p>
    <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi>f</mi>
                                <mo stretchy="false">(</mo>
                                <mi>X</mi>
                                <mo stretchy="false">)</mo>
                                <mo>∼</mo>
                                <mi>G</mi>
                                <mi>P</mi>
                                <mo stretchy="false">(</mo>
                                <mi>M</mi>
                                <mo stretchy="false">(</mo>
                                <mi>X</mi>
                                <mo stretchy="false">)</mo>
                                <mo separator="true">,</mo>
                                <mi>K</mi>
                                <mo stretchy="false">(</mo>
                                <mi>X</mi>
                                <mo separator="true">,</mo>
                                <mi>X</mi>
                                <mo stretchy="false">)</mo>
                                <mo stretchy="false">)</mo>
                                <mi mathvariant="normal">.</mi>
                            </mrow>
                            <annotation encoding="application/x-tex">f(X) \sim GP(M(X), K(X, X)).
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                            style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span
                            class="mord mathdefault" style="margin-right:0.07847em;">X</span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span
                            class="mord mathdefault">G</span><span class="mord mathdefault"
                            style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span
                            class="mord mathdefault" style="margin-right:0.10903em;">M</span><span
                            class="mopen">(</span><span class="mord mathdefault"
                            style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                            style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span
                            class="mord mathdefault" style="margin-right:0.07847em;">X</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                            style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span
                            class="mclose">)</span><span class="mord">.</span></span></span></span></span></p>
    <p>In this blog, we assume our GP has zero prior mean and replace <span class="katex"><span
                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>M</mi>
                            <mo stretchy="false">(</mo>
                            <mi>X</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">M(X)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.10903em;">M</span><span class="mopen">(</span><span
                        class="mord mathdefault" style="margin-right:0.07847em;">X</span><span
                        class="mclose">)</span></span></span></span> by <span class="katex"><span
                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mn>0</mn>
                        </mrow>
                        <annotation encoding="application/x-tex">0</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.64444em;vertical-align:0em;"></span><span
                        class="mord">0</span></span></span></span>.
        This is not a limitation of GPs, but it makes the notation easier.
        The covariance function, also referred to as kernel, is where we can apply any knowledge we have of the data we
        are modelling.
        A common choice is the squared exponential kernel:</p>
    <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi>k</mi>
                                <mo stretchy="false">(</mo>
                                <mi>x</mi>
                                <mo separator="true">,</mo>
                                <msup>
                                    <mi>x</mi>
                                    <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                </msup>
                                <mo stretchy="false">)</mo>
                                <mo>=</mo>
                                <msup>
                                    <mi>θ</mi>
                                    <mn>2</mn>
                                </msup>
                                <mi>exp</mi>
                                <mo>⁡</mo>
                                <mrow>
                                    <mo fence="true">(</mo>
                                    <mo>−</mo>
                                    <mfrac>
                                        <mrow>
                                            <mo stretchy="false">(</mo>
                                            <mi>x</mi>
                                            <mo>−</mo>
                                            <msup>
                                                <mi>x</mi>
                                                <mo mathvariant="normal" lspace="0em" rspace="0em">′</mo>
                                            </msup>
                                            <msup>
                                                <mo stretchy="false">)</mo>
                                                <mn>2</mn>
                                            </msup>
                                        </mrow>
                                        <mrow>
                                            <mn>2</mn>
                                            <msup>
                                                <mi mathvariant="normal">ℓ</mi>
                                                <mn>2</mn>
                                            </msup>
                                        </mrow>
                                    </mfrac>
                                    <mo fence="true">)</mo>
                                </mrow>
                            </mrow>
                            <annotation encoding="application/x-tex">k(x, x&#x27;) = \theta^2\exp\left(-\frac{(x -
                                x&#x27;)^2}{2\ell^2}\right)
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                            style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span
                            class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span
                                        class="vlist-r"><span class="vlist" style="height:0.801892em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight"><span
                                                            class="mord mtight">′</span></span></span></span></span></span></span></span></span><span
                            class="mclose">)</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.441138em;vertical-align:-0.95003em;"></span><span class="mord"><span
                                class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.8641079999999999em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">2</span></span></span></span></span></span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mop">exp</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="minner"><span
                                class="mopen delimcenter" style="top:0em;"><span
                                    class="delimsizing size3">(</span></span><span class="mord">−</span><span
                                class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.491108em;"><span style="top:-2.314em;"><span
                                                        class="pstrut" style="height:3em;"></span><span
                                                        class="mord"><span class="mord">2</span><span class="mord"><span
                                                                class="mord">ℓ</span><span class="msupsub"><span
                                                                    class="vlist-t"><span class="vlist-r"><span
                                                                            class="vlist"
                                                                            style="height:0.740108em;"><span
                                                                                style="top:-2.9890000000000003em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span
                                                    style="top:-3.23em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="frac-line"
                                                        style="border-bottom-width:0.04em;"></span></span><span
                                                    style="top:-3.677em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mopen">(</span><span
                                                            class="mord mathdefault">x</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">−</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord"><span class="mord mathdefault">x</span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.751892em;"><span
                                                                                style="top:-3.063em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight">′</span></span></span></span></span></span></span></span></span><span
                                                            class="mclose"><span class="mclose">)</span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.8141079999999999em;"><span
                                                                                style="top:-3.063em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.686em;"><span></span></span></span></span></span><span
                                    class="mclose nulldelimiter"></span></span><span class="mclose delimcenter"
                                style="top:0em;"><span
                                    class="delimsizing size3">)</span></span></span></span></span></span></span></p>
    <p>which has two hyper parameters: the length scale <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi mathvariant="normal">ℓ</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">\ell</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.69444em;vertical-align:0em;"></span><span
                        class="mord">ℓ</span></span></span></span> and the output variance
        <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <msup>
                                <mi>θ</mi>
                                <mn>2</mn>
                            </msup>
                        </mrow>
                        <annotation encoding="application/x-tex">\theta^2</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span
                            class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span
                                class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.8141079999999999em;"><span
                                            style="top:-3.063em;margin-right:0.05em;"><span class="pstrut"
                                                style="height:2.7em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>.
        The length scale represents an assumption of the amount of variation in your inputs, the higher the value the
        smoother the underlying function is assumed to be (and the more we can confidently extrapolate).
        The output variance is a scale factor and depends on the domain of the input.
        The core assumption in the squared exponential kernel is that data points that are close in input
        (&quot;similar&quot;), have high covariance (&quot;similar&quot; labels).
        There are many other options, such as linear kernels, periodic kernels and combinations are also possible.
        See David Duvenaud's excellent <a href="https://www.cs.toronto.edu/~duvenaud/cookbook/">kernel cookbook</a> for
        more.
    </p>
    <p>In GPs, we further assume that we can only observe noisy labels <span class="katex"><span
                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>Y</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">Y</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.22222em;">Y</span></span></span></span> (with noise
        <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>σ</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">\sigma</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.03588em;">σ</span></span></span></span>) of data.
        We define <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>F</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">F</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.13889em;">F</span></span></span></span> as the function values at <span
            class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>X</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">X</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07847em;">X</span></span></span></span>: <span class="katex"><span
                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>F</mi>
                            <mo>=</mo>
                            <mi>f</mi>
                            <mo stretchy="false">(</mo>
                            <mi>X</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">F = f(X)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.13889em;">F</span><span class="mspace"
                        style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                        class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                        class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span
                        class="mord mathdefault" style="margin-right:0.07847em;">X</span><span
                        class="mclose">)</span></span></span></span>:
    </p>
    <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi>Y</mi>
                                <mo>∼</mo>
                                <mi>N</mi>
                                <mo stretchy="false">(</mo>
                                <mi>Y</mi>
                                <mi mathvariant="normal">∣</mi>
                                <mi>F</mi>
                                <mo separator="true">,</mo>
                                <msup>
                                    <mi>σ</mi>
                                    <mn>2</mn>
                                </msup>
                                <mi>I</mi>
                                <mo stretchy="false">)</mo>
                                <mi mathvariant="normal">.</mi>
                            </mrow>
                            <annotation encoding="application/x-tex">Y \sim N(Y | F, \sigma^2I).
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                            style="margin-right:0.22222em;">Y</span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span
                            class="mord mathdefault" style="margin-right:0.10903em;">N</span><span
                            class="mopen">(</span><span class="mord mathdefault"
                            style="margin-right:0.22222em;">Y</span><span class="mord">∣</span><span
                            class="mord mathdefault" style="margin-right:0.13889em;">F</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord"><span
                                class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span
                                class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                            style="height:0.8641079999999999em;"><span
                                                style="top:-3.113em;margin-right:0.05em;"><span class="pstrut"
                                                    style="height:2.7em;"></span><span
                                                    class="sizing reset-size6 size3 mtight"><span
                                                        class="mord mtight">2</span></span></span></span></span></span></span></span><span
                            class="mord mathdefault" style="margin-right:0.07847em;">I</span><span
                            class="mclose">)</span><span class="mord">.</span></span></span></span></span></p>
    <p>We are interested in finding the predictive distribution <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>P</mi>
                            <mo stretchy="false">(</mo>
                            <msub>
                                <mi>f</mi>
                                <mo>∗</mo>
                            </msub>
                            <mi mathvariant="normal">∣</mi>
                            <msub>
                                <mi>x</mi>
                                <mo>∗</mo>
                            </msub>
                            <mo separator="true">,</mo>
                            <mi>X</mi>
                            <mo separator="true">,</mo>
                            <mi>Y</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">P(f_*|x_*, X, Y)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span
                            class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.175696em;"><span
                                            style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span
                                                class="pstrut" style="height:2.7em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mbin mtight">∗</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                        class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span
                            class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.175696em;"><span
                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                class="pstrut" style="height:2.7em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mbin mtight">∗</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                        class="mpunct">,</span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                        style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span> for
        new data point <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <msub>
                                <mi>x</mi>
                                <mo>∗</mo>
                            </msub>
                        </mrow>
                        <annotation encoding="application/x-tex">x_*</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span
                            class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.175696em;"><span
                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                class="pstrut" style="height:2.7em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mbin mtight">∗</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>,
        because it will allow us to make prediction for unseen
        data.</p>
    <p>The joint distribution of the noisy labels and unseen data is:</p>
    <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mrow>
                                    <mo fence="true">[</mo>
                                    <mtable rowspacing="0.15999999999999992em" columnspacing="1em">
                                        <mtr>
                                            <mtd>
                                                <mstyle scriptlevel="0" displaystyle="false">
                                                    <mi>Y</mi>
                                                </mstyle>
                                            </mtd>
                                        </mtr>
                                        <mtr>
                                            <mtd>
                                                <mstyle scriptlevel="0" displaystyle="false">
                                                    <msub>
                                                        <mi>f</mi>
                                                        <mo>∗</mo>
                                                    </msub>
                                                </mstyle>
                                            </mtd>
                                        </mtr>
                                    </mtable>
                                    <mo fence="true">]</mo>
                                </mrow>
                                <mo>∼</mo>
                                <mi>N</mi>
                                <mrow>
                                    <mo fence="true">(</mo>
                                    <mn>0</mn>
                                    <mo separator="true">,</mo>
                                    <mrow>
                                        <mo fence="true">[</mo>
                                        <mtable rowspacing="0.15999999999999992em" columnspacing="1em">
                                            <mtr>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mrow>
                                                            <mi>K</mi>
                                                            <mo stretchy="false">(</mo>
                                                            <mi>X</mi>
                                                            <mo separator="true">,</mo>
                                                            <mi>X</mi>
                                                            <mo stretchy="false">)</mo>
                                                            <mo>+</mo>
                                                            <msup>
                                                                <mi>σ</mi>
                                                                <mn>2</mn>
                                                            </msup>
                                                            <mi>I</mi>
                                                        </mrow>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mrow>
                                                            <mi>K</mi>
                                                            <mo stretchy="false">(</mo>
                                                            <mi>X</mi>
                                                            <mo separator="true">,</mo>
                                                            <msub>
                                                                <mi>x</mi>
                                                                <mo>∗</mo>
                                                            </msub>
                                                            <mo stretchy="false">)</mo>
                                                        </mrow>
                                                    </mstyle>
                                                </mtd>
                                            </mtr>
                                            <mtr>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mrow>
                                                            <mi>K</mi>
                                                            <mo stretchy="false">(</mo>
                                                            <msub>
                                                                <mi>x</mi>
                                                                <mo>∗</mo>
                                                            </msub>
                                                            <mo separator="true">,</mo>
                                                            <mi>X</mi>
                                                            <mo stretchy="false">)</mo>
                                                        </mrow>
                                                    </mstyle>
                                                </mtd>
                                                <mtd>
                                                    <mstyle scriptlevel="0" displaystyle="false">
                                                        <mrow>
                                                            <mi>K</mi>
                                                            <mo stretchy="false">(</mo>
                                                            <msub>
                                                                <mi>x</mi>
                                                                <mo>∗</mo>
                                                            </msub>
                                                            <mo separator="true">,</mo>
                                                            <msub>
                                                                <mi>x</mi>
                                                                <mo>∗</mo>
                                                            </msub>
                                                            <mo stretchy="false">)</mo>
                                                        </mrow>
                                                    </mstyle>
                                                </mtd>
                                            </mtr>
                                        </mtable>
                                        <mo fence="true">]</mo>
                                    </mrow>
                                    <mo fence="true">)</mo>
                                </mrow>
                                <mi mathvariant="normal">.</mi>
                            </mrow>
                            <annotation encoding="application/x-tex">\begin{bmatrix}
                                Y \\
                                f_*
                                \end{bmatrix}
                                \sim N\left(0, \begin{bmatrix}
                                K(X,X)+\sigma^2I &amp; K(X,x_*) \\
                                K(x_*,X) &amp; K(x_*,x_*)
                                \end{bmatrix}\right).
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span
                                class="mopen delimcenter" style="top:0em;"><span
                                    class="delimsizing size3">[</span></span><span class="mord"><span
                                    class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span
                                                class="vlist-r"><span class="vlist" style="height:1.45em;"><span
                                                        style="top:-3.61em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord mathdefault"
                                                                style="margin-right:0.22222em;">Y</span></span></span><span
                                                        style="top:-2.4099999999999997em;"><span class="pstrut"
                                                            style="height:3em;"></span><span class="mord"><span
                                                                class="mord"><span class="mord mathdefault"
                                                                    style="margin-right:0.10764em;">f</span><span
                                                                    class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.175696em;"><span
                                                                                    style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mbin mtight">∗</span></span></span></span><span
                                                                                class="vlist-s">​</span></span><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span
                                                    class="vlist-s">​</span></span><span class="vlist-r"><span
                                                    class="vlist"
                                                    style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span
                                class="mclose delimcenter" style="top:0em;"><span
                                    class="delimsizing size3">]</span></span></span><span class="mspace"
                            style="margin-right:0.2777777777777778em;"></span><span class="mrel">∼</span><span
                            class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span
                        class="base"><span class="strut"
                            style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mord mathdefault"
                            style="margin-right:0.10903em;">N</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="minner"><span
                                class="mopen delimcenter" style="top:0em;"><span
                                    class="delimsizing size3">(</span></span><span class="mord">0</span><span
                                class="mpunct">,</span><span class="mspace"
                                style="margin-right:0.16666666666666666em;"></span><span class="minner"><span
                                    class="mopen delimcenter" style="top:0em;"><span
                                        class="delimsizing size3">[</span></span><span class="mord"><span
                                        class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span
                                                    class="vlist-r"><span class="vlist" style="height:1.45em;"><span
                                                            style="top:-3.61em;"><span class="pstrut"
                                                                style="height:3em;"></span><span class="mord"><span
                                                                    class="mord mathdefault"
                                                                    style="margin-right:0.07153em;">K</span><span
                                                                    class="mopen">(</span><span class="mord mathdefault"
                                                                    style="margin-right:0.07847em;">X</span><span
                                                                    class="mpunct">,</span><span class="mspace"
                                                                    style="margin-right:0.16666666666666666em;"></span><span
                                                                    class="mord mathdefault"
                                                                    style="margin-right:0.07847em;">X</span><span
                                                                    class="mclose">)</span><span class="mspace"
                                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                                    class="mbin">+</span><span class="mspace"
                                                                    style="margin-right:0.2222222222222222em;"></span><span
                                                                    class="mord"><span class="mord mathdefault"
                                                                        style="margin-right:0.03588em;">σ</span><span
                                                                        class="msupsub"><span class="vlist-t"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.8141079999999999em;"><span
                                                                                        style="top:-3.063em;margin-right:0.05em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.7em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                                    class="mord mathdefault"
                                                                    style="margin-right:0.07847em;">I</span></span></span><span
                                                            style="top:-2.4099999999999997em;"><span class="pstrut"
                                                                style="height:3em;"></span><span class="mord"><span
                                                                    class="mord mathdefault"
                                                                    style="margin-right:0.07153em;">K</span><span
                                                                    class="mopen">(</span><span class="mord"><span
                                                                        class="mord mathdefault">x</span><span
                                                                        class="msupsub"><span
                                                                            class="vlist-t vlist-t2"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.175696em;"><span
                                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.7em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mbin mtight">∗</span></span></span></span><span
                                                                                    class="vlist-s">​</span></span><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                    class="mpunct">,</span><span class="mspace"
                                                                    style="margin-right:0.16666666666666666em;"></span><span
                                                                    class="mord mathdefault"
                                                                    style="margin-right:0.07847em;">X</span><span
                                                                    class="mclose">)</span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:0.9500000000000004em;"><span></span></span></span></span></span><span
                                            class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep"
                                            style="width:0.5em;"></span><span class="col-align-c"><span
                                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                        style="height:1.45em;"><span style="top:-3.61em;"><span
                                                                class="pstrut" style="height:3em;"></span><span
                                                                class="mord"><span class="mord mathdefault"
                                                                    style="margin-right:0.07153em;">K</span><span
                                                                    class="mopen">(</span><span class="mord mathdefault"
                                                                    style="margin-right:0.07847em;">X</span><span
                                                                    class="mpunct">,</span><span class="mspace"
                                                                    style="margin-right:0.16666666666666666em;"></span><span
                                                                    class="mord"><span
                                                                        class="mord mathdefault">x</span><span
                                                                        class="msupsub"><span
                                                                            class="vlist-t vlist-t2"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.175696em;"><span
                                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.7em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mbin mtight">∗</span></span></span></span><span
                                                                                    class="vlist-s">​</span></span><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                    class="mclose">)</span></span></span><span
                                                            style="top:-2.4099999999999997em;"><span class="pstrut"
                                                                style="height:3em;"></span><span class="mord"><span
                                                                    class="mord mathdefault"
                                                                    style="margin-right:0.07153em;">K</span><span
                                                                    class="mopen">(</span><span class="mord"><span
                                                                        class="mord mathdefault">x</span><span
                                                                        class="msupsub"><span
                                                                            class="vlist-t vlist-t2"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.175696em;"><span
                                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.7em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mbin mtight">∗</span></span></span></span><span
                                                                                    class="vlist-s">​</span></span><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                    class="mpunct">,</span><span class="mspace"
                                                                    style="margin-right:0.16666666666666666em;"></span><span
                                                                    class="mord"><span
                                                                        class="mord mathdefault">x</span><span
                                                                        class="msupsub"><span
                                                                            class="vlist-t vlist-t2"><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.175696em;"><span
                                                                                        style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                            class="pstrut"
                                                                                            style="height:2.7em;"></span><span
                                                                                            class="sizing reset-size6 size3 mtight"><span
                                                                                                class="mbin mtight">∗</span></span></span></span><span
                                                                                    class="vlist-s">​</span></span><span
                                                                                class="vlist-r"><span class="vlist"
                                                                                    style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                                    class="mclose">)</span></span></span></span><span
                                                        class="vlist-s">​</span></span><span class="vlist-r"><span
                                                        class="vlist"
                                                        style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span
                                    class="mclose delimcenter" style="top:0em;"><span
                                        class="delimsizing size3">]</span></span></span><span class="mclose delimcenter"
                                style="top:0em;"><span class="delimsizing size3">)</span></span></span><span
                            class="mspace" style="margin-right:0.16666666666666666em;"></span><span
                            class="mord">.</span></span></span></span></span></p>
    <p>With <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>K</mi>
                            <mo stretchy="false">(</mo>
                            <msub>
                                <mi>x</mi>
                                <mo>∗</mo>
                            </msub>
                            <mo separator="true">,</mo>
                            <mi>X</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">K(x_*, X)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span class="mord"><span
                            class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span
                                    class="vlist-r"><span class="vlist" style="height:0.175696em;"><span
                                            style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                class="pstrut" style="height:2.7em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mbin mtight">∗</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                        class="mpunct">,</span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span> a
        vector of kernel distances between the test data point and
        the training data. For more detail refer to equation 2.21 of the <a
            href="http://www.gaussianprocess.org/gpml/chapters/RW2.pdf">GPML
            book</a>. If we condition
        on <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>Y</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">Y</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.22222em;">Y</span></span></span></span> (the observed data), we obtain the
        equation for the mean and covariance
        of the predictive distribution:</p>
    <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em">
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>μ</mi>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>=</mo>
                                                <mi>K</mi>
                                                <mo stretchy="false">(</mo>
                                                <msub>
                                                    <mi>x</mi>
                                                    <mo>∗</mo>
                                                </msub>
                                                <mo separator="true">,</mo>
                                                <mi>X</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo stretchy="false">[</mo>
                                                <mi>K</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>X</mi>
                                                <mo separator="true">,</mo>
                                                <mi>X</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo>+</mo>
                                                <msubsup>
                                                    <mi>σ</mi>
                                                    <mi>n</mi>
                                                    <mn>2</mn>
                                                </msubsup>
                                                <mi>I</mi>
                                                <msup>
                                                    <mo stretchy="false">]</mo>
                                                    <mrow>
                                                        <mo>−</mo>
                                                        <mn>1</mn>
                                                    </mrow>
                                                </msup>
                                                <mi>Y</mi>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi mathvariant="normal">Σ</mi>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>=</mo>
                                                <mi>K</mi>
                                                <mo stretchy="false">(</mo>
                                                <msub>
                                                    <mi>x</mi>
                                                    <mo>∗</mo>
                                                </msub>
                                                <mo separator="true">,</mo>
                                                <msub>
                                                    <mi>x</mi>
                                                    <mo>∗</mo>
                                                </msub>
                                                <mo stretchy="false">)</mo>
                                                <mo>−</mo>
                                                <mi>K</mi>
                                                <mo stretchy="false">(</mo>
                                                <msub>
                                                    <mi>x</mi>
                                                    <mo>∗</mo>
                                                </msub>
                                                <mo separator="true">,</mo>
                                                <mi>X</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo stretchy="false">[</mo>
                                                <mi>K</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>X</mi>
                                                <mo separator="true">,</mo>
                                                <mi>X</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo>+</mo>
                                                <msup>
                                                    <mi>σ</mi>
                                                    <mn>2</mn>
                                                </msup>
                                                <mi>I</mi>
                                                <msup>
                                                    <mo stretchy="false">]</mo>
                                                    <mrow>
                                                        <mo>−</mo>
                                                        <mn>1</mn>
                                                    </mrow>
                                                </msup>
                                                <mi>K</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>X</mi>
                                                <mo separator="true">,</mo>
                                                <msub>
                                                    <mi>x</mi>
                                                    <mo>∗</mo>
                                                </msub>
                                                <mo stretchy="false">)</mo>
                                                <mi mathvariant="normal">.</mi>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                            </mtable>
                            <annotation encoding="application/x-tex">\begin{aligned}
                                \mu &amp;= K(x_*,X)[K(X,X) + \sigma^2_nI]^{-1}Y \\
                                \Sigma &amp;= K(x_*, x_*)-K(x_*, X)[K(X,X) + \sigma^2I]^{-1}K(X, x_*).
                                \end{aligned}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:3.048216em;vertical-align:-1.274108em;"></span><span class="mord"><span
                                class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span
                                            class="vlist-r"><span class="vlist" style="height:1.774108em;"><span
                                                    style="top:-3.91em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathdefault">μ</span></span></span><span
                                                    style="top:-2.385892em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord">Σ</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.274108em;"><span></span></span></span></span></span><span
                                    class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.774108em;"><span
                                                    style="top:-3.91em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">K</span><span
                                                            class="mopen">(</span><span class="mord"><span
                                                                class="mord mathdefault">x</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.175696em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mbin mtight">∗</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mclose">)</span><span class="mopen">[</span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">K</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">+</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord"><span class="mord mathdefault"
                                                                style="margin-right:0.03588em;">σ</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.8641079999999999em;"><span
                                                                                style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight">n</span></span></span><span
                                                                                style="top:-3.113em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.247em;"><span></span></span></span></span></span></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07847em;">I</span><span
                                                            class="mclose"><span class="mclose">]</span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.864108em;"><span
                                                                                style="top:-3.113em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight">−</span><span
                                                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.22222em;">Y</span></span></span><span
                                                    style="top:-2.385892em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">K</span><span
                                                            class="mopen">(</span><span class="mord"><span
                                                                class="mord mathdefault">x</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.175696em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mbin mtight">∗</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mord mathdefault">x</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.175696em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mbin mtight">∗</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">−</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">K</span><span
                                                            class="mopen">(</span><span class="mord"><span
                                                                class="mord mathdefault">x</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.175696em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mbin mtight">∗</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mclose">)</span><span class="mopen">[</span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">K</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">+</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord"><span class="mord mathdefault"
                                                                style="margin-right:0.03588em;">σ</span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.8641079999999999em;"><span
                                                                                style="top:-3.113em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07847em;">I</span><span
                                                            class="mclose"><span class="mclose">]</span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.864108em;"><span
                                                                                style="top:-3.113em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight">−</span><span
                                                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">K</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mord mathdefault">x</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.175696em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mbin mtight">∗</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mclose">)</span><span
                                                            class="mord">.</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.274108em;"><span></span></span></span></span></span></span></span></span></span></span></span>
    </p>
    <p>The equation for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi mathvariant="normal">Σ</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">\Sigma</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span
                        class="mord">Σ</span></span></span></span> contains an inverse of the covariance matrix of the
        data set.
        We can only stably invert covariance matrices up to a few thousand points.
        After that it becomes very slow, even on modern GPUs, and can also fail due to numeric problems.
        One way to go around this limitation is to exploit the fact that there is often a lot of redundancy in the
        training set.
        By using only the points that are most informative we can drastically reduce computation.
        GPs that work on such a reduced data set are called &quot;Sparse Gaussian Processes&quot;.</p>
    <h3 id="sparse-gaussian-processes">Sparse Gaussian Processes</h3>
    <p>The first Sparse GPs relied on smartly picking a subset of the training data, this subset is also referred to as
        the &quot;inducing points&quot;, and computing the inverse on those.
        This allows us to reduce the computation from depending on the number of data points to depending on the number
        of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>m</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">m</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.43056em;vertical-align:0em;"></span><span
                        class="mord mathdefault">m</span></span></span></span> induced points.
        See <a href="http://www.jmlr.org/papers/volume6/quinonero-candela05a/quinonero-candela05a.pdf">Quiñonero-Candela
            et al.</a> for a nice overview.</p>
    <p>Later methods removed the reliance on selecting an actual subset of the data points (<a
            href="http://mlg.eng.cam.ac.uk/zoubin/papers/nips05spgp.pdf">Snelson et al.</a>) by introducing the concept
        of &quot;pseudo&quot; inducing points.
        It was <a href="http://proceedings.mlr.press/v5/titsias09a/titsias09a.pdf">Titsias</a> who introduced the first
        variational approximation to optimising sparse GPs, where the pseudo inducing points are optimised as
        variational parameters.
        In contrast to previous approaches, the &quot;Titsias approximation&quot; made optimising the pseudo
        inducing points part of the variational objective, providing a unified and rigorous way to
        optimise them.</p>
    <p>The definition of sparse GPs is a bit different from full GPs. Below we follow the derivation of <a
            href="http://www.auai.org/uai2013/prints/papers/244.pdf">Hensman et al.</a>:</p>
    <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em">
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>Y</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>F</mi>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>=</mo>
                                                <mi>N</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>Y</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>F</mi>
                                                <mo separator="true">,</mo>
                                                <msup>
                                                    <mi>σ</mi>
                                                    <mn>2</mn>
                                                </msup>
                                                <mi>I</mi>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>F</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>U</mi>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>=</mo>
                                                <mi>N</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>F</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>K</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>X</mi>
                                                <mo separator="true">,</mo>
                                                <mi>Z</mi>
                                                <mo stretchy="false">)</mo>
                                                <mi>K</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>Z</mi>
                                                <mo separator="true">,</mo>
                                                <mi>Z</mi>
                                                <msup>
                                                    <mo stretchy="false">)</mo>
                                                    <mrow>
                                                        <mo>−</mo>
                                                        <mn>1</mn>
                                                    </mrow>
                                                </msup>
                                                <mi>U</mi>
                                                <mo separator="true">,</mo>
                                                <mover accent="true">
                                                    <mi>K</mi>
                                                    <mo>~</mo>
                                                </mover>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>U</mi>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>=</mo>
                                                <mi>N</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>U</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mn>0</mn>
                                                <mo separator="true">,</mo>
                                                <mi>K</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>Z</mi>
                                                <mo separator="true">,</mo>
                                                <mi>Z</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                            </mtable>
                            <annotation encoding="application/x-tex">\begin{aligned}
                                p(Y|F) &amp;= N(Y|F,\sigma^2 I) \\
                                p(F|U) &amp;= N(F| K(X,Z)K(Z,Z)^{-1}U,\tilde{K}) \\
                                p(U) &amp;= N(U| 0, K(Z,Z))
                                \end{aligned}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:4.604298em;vertical-align:-2.052149em;"></span><span class="mord"><span
                                class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span
                                            class="vlist-r"><span class="vlist" style="height:2.552149em;"><span
                                                    style="top:-4.688041em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.22222em;">Y</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mclose">)</span></span></span><span
                                                    style="top:-3.107851em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.10903em;">U</span><span
                                                            class="mclose">)</span></span></span><span
                                                    style="top:-1.6078510000000001em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.10903em;">U</span><span
                                                            class="mclose">)</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:2.052149em;"><span></span></span></span></span></span><span
                                    class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:2.552149em;"><span
                                                    style="top:-4.688041em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.10903em;">N</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.22222em;">Y</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mord mathdefault"
                                                                style="margin-right:0.03588em;">σ</span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.8641079999999999em;"><span
                                                                                style="top:-3.113em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight">2</span></span></span></span></span></span></span></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07847em;">I</span><span
                                                            class="mclose">)</span></span></span><span
                                                    style="top:-3.107851em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.10903em;">N</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">K</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07847em;">X</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mclose">)</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">K</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mclose"><span class="mclose">)</span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.864108em;"><span
                                                                                style="top:-3.113em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight">−</span><span
                                                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.10903em;">U</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord accent"><span class="vlist-t"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:0.9201899999999998em;"><span
                                                                            style="top:-3em;"><span class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="mord"><span
                                                                                    class="mord mathdefault"
                                                                                    style="margin-right:0.07153em;">K</span></span></span><span
                                                                            style="top:-3.6023300000000003em;"><span
                                                                                class="pstrut"
                                                                                style="height:3em;"></span><span
                                                                                class="accent-body"
                                                                                style="left:-0.19444em;"><span
                                                                                    class="mord">~</span></span></span></span></span></span></span><span
                                                            class="mclose">)</span></span></span><span
                                                    style="top:-1.6078510000000001em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.10903em;">N</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.10903em;">U</span><span
                                                            class="mord">∣</span><span class="mord">0</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">K</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mclose">)</span><span
                                                            class="mclose">)</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:2.052149em;"><span></span></span></span></span></span></span></span></span></span></span></span>
    </p>
    <p>With <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>U</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">U</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.10903em;">U</span></span></span></span> containing values of the function
        <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>f</mi>
                            <mo stretchy="false">(</mo>
                            <mo>⋅</mo>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">f(\cdot)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span
                        class="mord">⋅</span><span class="mclose">)</span></span></span></span> at the (pseudo-)
        inducing points <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>Z</mi>
                            <mo>=</mo>
                            <mo stretchy="false">{</mo>
                            <msub>
                                <mi>z</mi>
                                <mi>i</mi>
                            </msub>
                            <msubsup>
                                <mo stretchy="false">}</mo>
                                <mrow>
                                    <mi>i</mi>
                                    <mo>=</mo>
                                    <mn>1</mn>
                                </mrow>
                                <mi>m</mi>
                            </msubsup>
                        </mrow>
                        <annotation encoding="application/x-tex">Z = \{z_i\}_{i=1}^m</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span><span class="mspace"
                        style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                        class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                        class="strut" style="height:1.008664em;vertical-align:-0.258664em;"></span><span
                        class="mopen">{</span><span class="mord"><span class="mord mathdefault"
                            style="margin-right:0.04398em;">z</span><span class="msupsub"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.31166399999999994em;"><span
                                            style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span
                                                class="pstrut" style="height:2.7em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathdefault mtight">i</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.15em;"><span></span></span></span></span></span></span><span
                        class="mclose"><span class="mclose">}</span><span class="msupsub"><span
                                class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                        style="height:0.664392em;"><span
                                            style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span
                                                class="pstrut" style="height:2.7em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mathdefault mtight">i</span><span
                                                        class="mrel mtight">=</span><span
                                                        class="mord mtight">1</span></span></span></span><span
                                            style="top:-3.063em;margin-right:0.05em;"><span class="pstrut"
                                                style="height:2.7em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span
                                                    class="mord mathdefault mtight">m</span></span></span></span><span
                                        class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                        style="height:0.258664em;"><span></span></span></span></span></span></span></span></span></span>
        and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mover accent="true">
                                <mi>K</mi>
                                <mo>~</mo>
                            </mover>
                            <mo>=</mo>
                            <mi>K</mi>
                            <mo stretchy="false">(</mo>
                            <mi>X</mi>
                            <mo separator="true">,</mo>
                            <mi>X</mi>
                            <mo stretchy="false">)</mo>
                            <mo>−</mo>
                            <mi>K</mi>
                            <mo stretchy="false">(</mo>
                            <mi>X</mi>
                            <mo separator="true">,</mo>
                            <mi>Z</mi>
                            <mo stretchy="false">)</mo>
                            <mi>K</mi>
                            <mo stretchy="false">(</mo>
                            <mi>Z</mi>
                            <mo separator="true">,</mo>
                            <mi>Z</mi>
                            <msup>
                                <mo stretchy="false">)</mo>
                                <mrow>
                                    <mo>−</mo>
                                    <mn>1</mn>
                                </mrow>
                            </msup>
                            <mi>K</mi>
                            <mo stretchy="false">(</mo>
                            <mi>Z</mi>
                            <mo separator="true">,</mo>
                            <mi>X</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">\tilde{K} = K(X,X) - K(X,Z)K(Z,Z)^{-1}K(Z,X)
                        </annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.9201899999999998em;vertical-align:0em;"></span><span class="mord accent"><span
                            class="vlist-t"><span class="vlist-r"><span class="vlist"
                                    style="height:0.9201899999999998em;"><span style="top:-3em;"><span class="pstrut"
                                            style="height:3em;"></span><span class="mord"><span class="mord mathdefault"
                                                style="margin-right:0.07153em;">K</span></span></span><span
                                        style="top:-3.6023300000000003em;"><span class="pstrut"
                                            style="height:3em;"></span><span class="accent-body"
                                            style="left:-0.19444em;"><span
                                                class="mord">~</span></span></span></span></span></span></span><span
                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                        class="mrel">=</span><span class="mspace"
                        style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span
                        class="mord mathdefault" style="margin-right:0.07847em;">X</span><span
                        class="mpunct">,</span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace"
                        style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span
                        class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span
                        class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span
                        class="mord mathdefault" style="margin-right:0.07153em;">K</span><span
                        class="mopen">(</span><span class="mord mathdefault"
                        style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span><span class="mclose">)</span><span
                        class="mord mathdefault" style="margin-right:0.07153em;">K</span><span
                        class="mopen">(</span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span><span class="mpunct">,</span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span><span class="mclose"><span class="mclose">)</span><span
                            class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist"
                                        style="height:0.8141079999999999em;"><span
                                            style="top:-3.063em;margin-right:0.05em;"><span class="pstrut"
                                                style="height:2.7em;"></span><span
                                                class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span
                                                        class="mord mtight">−</span><span
                                                        class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                        class="mord mathdefault" style="margin-right:0.07153em;">K</span><span
                        class="mopen">(</span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span><span class="mpunct">,</span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span>.
        Notice that the matrix inverse is on <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>K</mi>
                            <mo stretchy="false">(</mo>
                            <mi>Z</mi>
                            <mo separator="true">,</mo>
                            <mi>Z</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">K(Z,Z)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span
                        class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span
                        class="mpunct">,</span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span><span class="mclose">)</span></span></span></span> now,
        making it dependent on the number of inducing points we pick.
        It no longer grows with the data set.
        The difference between this approximation and the full GP is given by the following KL divergence:
    </p>
    <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing="">
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mi>K</mi>
                                                <mi>L</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>F</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>U</mi>
                                                <mo stretchy="false">)</mo>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>F</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>U</mi>
                                                <mo separator="true">,</mo>
                                                <mi>Y</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                            </mtable>
                            <annotation encoding="application/x-tex">\begin{aligned}
                                KL(p(F|U) || p(F|U,Y))
                                \end{aligned}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1.5000000000000002em;vertical-align:-0.5000000000000002em;"></span><span
                            class="mord"><span class="mtable"><span class="col-align-r"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1em;"><span style="top:-3.16em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">K</span><span
                                                            class="mord mathdefault">L</span><span
                                                            class="mopen">(</span><span
                                                            class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.10903em;">U</span><span
                                                            class="mclose">)</span><span class="mord">∣</span><span
                                                            class="mord">∣</span><span
                                                            class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.10903em;">U</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.22222em;">Y</span><span
                                                            class="mclose">)</span><span
                                                            class="mclose">)</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:0.5000000000000002em;"><span></span></span></span></span></span></span></span></span></span></span></span>
    </p>
    <p>Note that we write <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>P</mi>
                            <mo stretchy="false">(</mo>
                            <mi>F</mi>
                            <mi mathvariant="normal">∣</mi>
                            <mi>U</mi>
                            <mo separator="true">,</mo>
                            <mi>Y</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">P(F|U,Y)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span
                        class="mord mathdefault" style="margin-right:0.13889em;">F</span><span
                        class="mord">∣</span><span class="mord mathdefault"
                        style="margin-right:0.10903em;">U</span><span class="mpunct">,</span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                        style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span> and
        not <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>P</mi>
                            <mo stretchy="false">(</mo>
                            <mi>F</mi>
                            <mi mathvariant="normal">∣</mi>
                            <mi>Y</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">P(F|Y)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span
                        class="mord mathdefault" style="margin-right:0.13889em;">F</span><span
                        class="mord">∣</span><span class="mord mathdefault"
                        style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span> as
        second distribution, because <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>U</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">U</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.10903em;">U</span></span></span></span> may not fully overlap with Y if we
        use <strong>pseudo</strong> inducing points.
        If <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>U</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">U</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.10903em;">U</span></span></span></span> contains all <span
            class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>n</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">n</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.43056em;vertical-align:0em;"></span><span
                        class="mord mathdefault">n</span></span></span></span> training function values, meaning that
        <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>U</mi>
                            <mo>=</mo>
                            <mi>F</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">U = F</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.10903em;">U</span><span class="mspace"
                        style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                        class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                        class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.13889em;">F</span></span></span></span>, then <span class="katex"><span
                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>K</mi>
                            <mo stretchy="false">(</mo>
                            <mi>X</mi>
                            <mo separator="true">,</mo>
                            <mi>Z</mi>
                            <mo stretchy="false">)</mo>
                            <mo>=</mo>
                            <mi>K</mi>
                            <mo stretchy="false">(</mo>
                            <mi>Z</mi>
                            <mo separator="true">,</mo>
                            <mi>Z</mi>
                            <mo stretchy="false">)</mo>
                            <mo>=</mo>
                            <mi>K</mi>
                            <mo stretchy="false">(</mo>
                            <mi>X</mi>
                            <mo separator="true">,</mo>
                            <mi>X</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">K(X,Z) = K(Z,Z) = K(X,X)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span
                        class="mord mathdefault" style="margin-right:0.07847em;">X</span><span
                        class="mpunct">,</span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span><span class="mclose">)</span><span class="mspace"
                        style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                        class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                        class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span
                        class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span
                        class="mpunct">,</span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span><span class="mclose">)</span><span class="mspace"
                        style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span
                        class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span
                        class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">K</span><span class="mopen">(</span><span
                        class="mord mathdefault" style="margin-right:0.07847em;">X</span><span
                        class="mpunct">,</span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span> and
        so <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mover accent="true">
                                <mi>K</mi>
                                <mo>~</mo>
                            </mover>
                            <mo>=</mo>
                            <mn>0</mn>
                        </mrow>
                        <annotation encoding="application/x-tex">\tilde{K} = 0</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.9201899999999998em;vertical-align:0em;"></span><span class="mord accent"><span
                            class="vlist-t"><span class="vlist-r"><span class="vlist"
                                    style="height:0.9201899999999998em;"><span style="top:-3em;"><span class="pstrut"
                                            style="height:3em;"></span><span class="mord"><span class="mord mathdefault"
                                                style="margin-right:0.07153em;">K</span></span></span><span
                                        style="top:-3.6023300000000003em;"><span class="pstrut"
                                            style="height:3em;"></span><span class="accent-body"
                                            style="left:-0.19444em;"><span
                                                class="mord">~</span></span></span></span></span></span></span><span
                        class="mspace" style="margin-right:0.2777777777777778em;"></span><span
                        class="mrel">=</span><span class="mspace"
                        style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut"
                        style="height:0.64444em;vertical-align:0em;"></span><span
                        class="mord">0</span></span></span></span>.
        In that case the KL divergence is zero, because both distributions are degenerate and we recover the full GP.
        However we lost the computational gain, because the matrix inverse is of the order of the original data set
        again.
    </p>
    <h2 id="finding-an-approximate-posterior">Finding an approximate posterior</h2>
    <p>We introduce an approximate posterior distribution <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>q</mi>
                            <mo stretchy="false">(</mo>
                            <mi>F</mi>
                            <mi mathvariant="normal">∣</mi>
                            <mi>U</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">q(F|U)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span
                        class="mord mathdefault" style="margin-right:0.13889em;">F</span><span
                        class="mord">∣</span><span class="mord mathdefault"
                        style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span> and
        attempt to
        minimise its distance to the true posterior <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>p</mi>
                            <mo stretchy="false">(</mo>
                            <mi>F</mi>
                            <mi mathvariant="normal">∣</mi>
                            <mi>U</mi>
                            <mo separator="true">,</mo>
                            <mi>Y</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">p(F|U,Y)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span
                        class="mopen">(</span><span class="mord mathdefault"
                        style="margin-right:0.13889em;">F</span><span class="mord">∣</span><span
                        class="mord mathdefault" style="margin-right:0.10903em;">U</span><span
                        class="mpunct">,</span><span class="mspace"
                        style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                        style="margin-right:0.22222em;">Y</span><span class="mclose">)</span></span></span></span>. We
        start from a similar
        divergence as in the VAE and show we can find a bound we can directly optimise with
        respect to the pseudo inducing points.</p>
    <p>The KL we are interested in minimising is:</p>
    <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mrow>
                                <mi>K</mi>
                                <mi>L</mi>
                                <mo stretchy="false">(</mo>
                                <mi>q</mi>
                                <mo stretchy="false">(</mo>
                                <mi>F</mi>
                                <mi mathvariant="normal">∣</mi>
                                <mi>U</mi>
                                <mo stretchy="false">)</mo>
                                <mi mathvariant="normal">∣</mi>
                                <mi mathvariant="normal">∣</mi>
                                <mi>p</mi>
                                <mo stretchy="false">(</mo>
                                <mi>F</mi>
                                <mi mathvariant="normal">∣</mi>
                                <mi>U</mi>
                                <mo separator="true">,</mo>
                                <mi>Y</mi>
                                <mo stretchy="false">)</mo>
                                <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">KL(q(F|U) || p(F|U,Y))
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                            style="margin-right:0.07153em;">K</span><span class="mord mathdefault">L</span><span
                            class="mopen">(</span><span class="mord mathdefault"
                            style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span
                            class="mord mathdefault" style="margin-right:0.13889em;">F</span><span
                            class="mord">∣</span><span class="mord mathdefault"
                            style="margin-right:0.10903em;">U</span><span class="mclose">)</span><span
                            class="mord">∣</span><span class="mord">∣</span><span class="mord mathdefault">p</span><span
                            class="mopen">(</span><span class="mord mathdefault"
                            style="margin-right:0.13889em;">F</span><span class="mord">∣</span><span
                            class="mord mathdefault" style="margin-right:0.10903em;">U</span><span
                            class="mpunct">,</span><span class="mspace"
                            style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault"
                            style="margin-right:0.22222em;">Y</span><span class="mclose">)</span><span
                            class="mclose">)</span></span></span></span></span></p>
    <p>Intuitively, we can interpret this as the difference between having only access to
        the inducing points as compared to having access to both the inducing and the
        original data points. If this difference is small, then q holds all the
        information we need.</p>
    <p>Like before, we will write out the KL divergence in (now) familiar components:</p>
    <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em">
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mo lspace="0em" rspace="0em">=</mo>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>−</mo>
                                                <msub>
                                                    <mo>∫</mo>
                                                    <mi>F</mi>
                                                </msub>
                                                <mi>q</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>F</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>U</mi>
                                                <mo stretchy="false">)</mo>
                                                <mi>log</mi>
                                                <mo>⁡</mo>
                                                <mfrac>
                                                    <mrow>
                                                        <mi>p</mi>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>F</mi>
                                                        <mi mathvariant="normal">∣</mi>
                                                        <mi>U</mi>
                                                        <mo separator="true">,</mo>
                                                        <mi>Y</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mrow>
                                                        <mi>q</mi>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>F</mi>
                                                        <mi mathvariant="normal">∣</mi>
                                                        <mi>U</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                </mfrac>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mo lspace="0em" rspace="0em">=</mo>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>−</mo>
                                                <msub>
                                                    <mo>∫</mo>
                                                    <mi>F</mi>
                                                </msub>
                                                <mi>q</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>F</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>U</mi>
                                                <mo stretchy="false">)</mo>
                                                <mi>log</mi>
                                                <mo>⁡</mo>
                                                <mfrac>
                                                    <mrow>
                                                        <mi>p</mi>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>Y</mi>
                                                        <mi mathvariant="normal">∣</mi>
                                                        <mi>U</mi>
                                                        <mo separator="true">,</mo>
                                                        <mi>F</mi>
                                                        <mo stretchy="false">)</mo>
                                                        <mi>p</mi>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>F</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                    <mrow>
                                                        <mi>q</mi>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>F</mi>
                                                        <mi mathvariant="normal">∣</mi>
                                                        <mi>U</mi>
                                                        <mo stretchy="false">)</mo>
                                                        <mi>p</mi>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>Y</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                </mfrac>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mo lspace="0em" rspace="0em">=</mo>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>−</mo>
                                                <msub>
                                                    <mo>∫</mo>
                                                    <mi>F</mi>
                                                </msub>
                                                <mi>q</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>F</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>U</mi>
                                                <mo stretchy="false">)</mo>
                                                <mrow>
                                                    <mo fence="true">[</mo>
                                                    <mi>log</mi>
                                                    <mo>⁡</mo>
                                                    <mi>p</mi>
                                                    <mo stretchy="false">(</mo>
                                                    <mi>Y</mi>
                                                    <mi mathvariant="normal">∣</mi>
                                                    <mi>U</mi>
                                                    <mo separator="true">,</mo>
                                                    <mi>F</mi>
                                                    <mo stretchy="false">)</mo>
                                                    <mo>+</mo>
                                                    <mi>log</mi>
                                                    <mo>⁡</mo>
                                                    <mi>p</mi>
                                                    <mo stretchy="false">(</mo>
                                                    <mi>F</mi>
                                                    <mo stretchy="false">)</mo>
                                                    <mo>−</mo>
                                                    <mi>log</mi>
                                                    <mo>⁡</mo>
                                                    <mi>q</mi>
                                                    <mo stretchy="false">(</mo>
                                                    <mi>F</mi>
                                                    <mi mathvariant="normal">∣</mi>
                                                    <mi>U</mi>
                                                    <mo stretchy="false">)</mo>
                                                    <mo>−</mo>
                                                    <mi>log</mi>
                                                    <mo>⁡</mo>
                                                    <mi>p</mi>
                                                    <mo stretchy="false">(</mo>
                                                    <mi>Y</mi>
                                                    <mo stretchy="false">)</mo>
                                                    <mo fence="true">]</mo>
                                                </mrow>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mo lspace="0em" rspace="0em">=</mo>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mi>log</mi>
                                                <mo>⁡</mo>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>Y</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo>−</mo>
                                                <msub>
                                                    <mi mathvariant="double-struck">E</mi>
                                                    <mrow>
                                                        <mi>q</mi>
                                                        <mo stretchy="false">(</mo>
                                                        <mi>F</mi>
                                                        <mi mathvariant="normal">∣</mi>
                                                        <mi>U</mi>
                                                        <mo stretchy="false">)</mo>
                                                    </mrow>
                                                </msub>
                                                <mo stretchy="false">[</mo>
                                                <mi>log</mi>
                                                <mo>⁡</mo>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>Y</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>U</mi>
                                                <mo separator="true">,</mo>
                                                <mi>F</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo stretchy="false">]</mo>
                                                <mo>−</mo>
                                                <mi>K</mi>
                                                <mi>L</mi>
                                                <mo stretchy="false">[</mo>
                                                <mi>q</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>F</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>U</mi>
                                                <mo stretchy="false">)</mo>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>F</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo stretchy="false">]</mo>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                            </mtable>
                            <annotation encoding="application/x-tex">\begin{aligned}
                                =&amp; - \int_F q(F|U) \log \frac{p(F|U,Y)}{q(F|U)} \\
                                =&amp; - \int_F q(F|U) \log \frac{p(Y|U,F)p(F)}{q(F|U)p(Y)} \\
                                =&amp; - \int_F q(F|U) \left [ \log p(Y|U,F) + \log p(F) - \log q(F|U) - \log p(Y)
                                \right ] \\
                                =&amp; \log p(Y) - \mathbb{E}_{q(F|U)}[\log p(Y|U,F)] - KL[q(F|U) || p(F)]
                                \end{aligned}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:9.397950000000002em;vertical-align:-4.448975000000002em;"></span><span
                            class="mord"><span class="mtable"><span class="col-align-r"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:4.948975000000001em;"><span
                                                    style="top:-6.948975000000001em;"><span class="pstrut"
                                                        style="height:3.427em;"></span><span class="mord"><span
                                                            class="mrel">=</span></span></span><span
                                                    style="top:-4.2859750000000005em;"><span class="pstrut"
                                                        style="height:3.427em;"></span><span class="mord"><span
                                                            class="mrel">=</span></span></span><span
                                                    style="top:-1.6899749999999991em;"><span class="pstrut"
                                                        style="height:3.427em;"></span><span class="mord"><span
                                                            class="mrel">=</span></span></span><span
                                                    style="top:0.3619750000000015em;"><span class="pstrut"
                                                        style="height:3.427em;"></span><span class="mord"><span
                                                            class="mrel">=</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:4.448975000000002em;"><span></span></span></span></span></span><span
                                    class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:4.948975000000001em;"><span
                                                    style="top:-6.948975000000001em;"><span class="pstrut"
                                                        style="height:3.427em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">−</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mop"><span class="mop op-symbol large-op"
                                                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:-0.433619em;"><span
                                                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.13889em;">F</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.03588em;">q</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.10903em;">U</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mop">lo<span
                                                                style="margin-right:0.01389em;">g</span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mopen nulldelimiter"></span><span
                                                                class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:1.427em;"><span
                                                                                style="top:-2.314em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="mord"><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.03588em;">q</span><span
                                                                                        class="mopen">(</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.13889em;">F</span><span
                                                                                        class="mord">∣</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.10903em;">U</span><span
                                                                                        class="mclose">)</span></span></span><span
                                                                                style="top:-3.23em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="frac-line"
                                                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                                                style="top:-3.677em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="mord"><span
                                                                                        class="mord mathdefault">p</span><span
                                                                                        class="mopen">(</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.13889em;">F</span><span
                                                                                        class="mord">∣</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.10903em;">U</span><span
                                                                                        class="mpunct">,</span><span
                                                                                        class="mspace"
                                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.22222em;">Y</span><span
                                                                                        class="mclose">)</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.936em;"><span></span></span></span></span></span><span
                                                                class="mclose nulldelimiter"></span></span></span></span><span
                                                    style="top:-4.2859750000000005em;"><span class="pstrut"
                                                        style="height:3.427em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">−</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mop"><span class="mop op-symbol large-op"
                                                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:-0.433619em;"><span
                                                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.13889em;">F</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.03588em;">q</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.10903em;">U</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mop">lo<span
                                                                style="margin-right:0.01389em;">g</span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mopen nulldelimiter"></span><span
                                                                class="mfrac"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:1.427em;"><span
                                                                                style="top:-2.314em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="mord"><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.03588em;">q</span><span
                                                                                        class="mopen">(</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.13889em;">F</span><span
                                                                                        class="mord">∣</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.10903em;">U</span><span
                                                                                        class="mclose">)</span><span
                                                                                        class="mord mathdefault">p</span><span
                                                                                        class="mopen">(</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.22222em;">Y</span><span
                                                                                        class="mclose">)</span></span></span><span
                                                                                style="top:-3.23em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="frac-line"
                                                                                    style="border-bottom-width:0.04em;"></span></span><span
                                                                                style="top:-3.677em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:3em;"></span><span
                                                                                    class="mord"><span
                                                                                        class="mord mathdefault">p</span><span
                                                                                        class="mopen">(</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.22222em;">Y</span><span
                                                                                        class="mord">∣</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.10903em;">U</span><span
                                                                                        class="mpunct">,</span><span
                                                                                        class="mspace"
                                                                                        style="margin-right:0.16666666666666666em;"></span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.13889em;">F</span><span
                                                                                        class="mclose">)</span><span
                                                                                        class="mord mathdefault">p</span><span
                                                                                        class="mopen">(</span><span
                                                                                        class="mord mathdefault"
                                                                                        style="margin-right:0.13889em;">F</span><span
                                                                                        class="mclose">)</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.936em;"><span></span></span></span></span></span><span
                                                                class="mclose nulldelimiter"></span></span></span></span><span
                                                    style="top:-1.6899749999999991em;"><span class="pstrut"
                                                        style="height:3.427em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">−</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mop"><span class="mop op-symbol large-op"
                                                                style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:-0.433619em;"><span
                                                                                style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight"
                                                                                        style="margin-right:0.13889em;">F</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.03588em;">q</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.10903em;">U</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="minner"><span class="mopen delimcenter"
                                                                style="top:0em;">[</span><span class="mop">lo<span
                                                                    style="margin-right:0.01389em;">g</span></span><span
                                                                class="mspace"
                                                                style="margin-right:0.16666666666666666em;"></span><span
                                                                class="mord mathdefault">p</span><span
                                                                class="mopen">(</span><span class="mord mathdefault"
                                                                style="margin-right:0.22222em;">Y</span><span
                                                                class="mord">∣</span><span class="mord mathdefault"
                                                                style="margin-right:0.10903em;">U</span><span
                                                                class="mpunct">,</span><span class="mspace"
                                                                style="margin-right:0.16666666666666666em;"></span><span
                                                                class="mord mathdefault"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mclose">)</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mbin">+</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mop">lo<span
                                                                    style="margin-right:0.01389em;">g</span></span><span
                                                                class="mspace"
                                                                style="margin-right:0.16666666666666666em;"></span><span
                                                                class="mord mathdefault">p</span><span
                                                                class="mopen">(</span><span class="mord mathdefault"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mclose">)</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mbin">−</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mop">lo<span
                                                                    style="margin-right:0.01389em;">g</span></span><span
                                                                class="mspace"
                                                                style="margin-right:0.16666666666666666em;"></span><span
                                                                class="mord mathdefault"
                                                                style="margin-right:0.03588em;">q</span><span
                                                                class="mopen">(</span><span class="mord mathdefault"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="mord">∣</span><span class="mord mathdefault"
                                                                style="margin-right:0.10903em;">U</span><span
                                                                class="mclose">)</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mbin">−</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mop">lo<span
                                                                    style="margin-right:0.01389em;">g</span></span><span
                                                                class="mspace"
                                                                style="margin-right:0.16666666666666666em;"></span><span
                                                                class="mord mathdefault">p</span><span
                                                                class="mopen">(</span><span class="mord mathdefault"
                                                                style="margin-right:0.22222em;">Y</span><span
                                                                class="mclose">)</span><span class="mclose delimcenter"
                                                                style="top:0em;">]</span></span></span></span><span
                                                    style="top:0.3619750000000015em;"><span class="pstrut"
                                                        style="height:3.427em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mop">lo<span
                                                                style="margin-right:0.01389em;">g</span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.22222em;">Y</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">−</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord"><span class="mord"><span
                                                                    class="mord mathbb">E</span></span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.34480000000000005em;"><span
                                                                                style="top:-2.5198em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mathdefault mtight"
                                                                                            style="margin-right:0.03588em;">q</span><span
                                                                                            class="mopen mtight">(</span><span
                                                                                            class="mord mathdefault mtight"
                                                                                            style="margin-right:0.13889em;">F</span><span
                                                                                            class="mord mtight">∣</span><span
                                                                                            class="mord mathdefault mtight"
                                                                                            style="margin-right:0.10903em;">U</span><span
                                                                                            class="mclose mtight">)</span></span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span
                                                            class="mopen">[</span><span class="mop">lo<span
                                                                style="margin-right:0.01389em;">g</span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.22222em;">Y</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.10903em;">U</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mclose">)</span><span class="mclose">]</span><span
                                                            class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">−</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">K</span><span
                                                            class="mord mathdefault">L</span><span
                                                            class="mopen">[</span><span class="mord mathdefault"
                                                            style="margin-right:0.03588em;">q</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.10903em;">U</span><span
                                                            class="mclose">)</span><span class="mord">∣</span><span
                                                            class="mord">∣</span><span
                                                            class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mclose">)</span><span
                                                            class="mclose">]</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:4.448975000000002em;"><span></span></span></span></span></span></span></span></span></span></span></span>
    </p>
    <p>The first to the second step is done using Bayes' rule.
        The second to the third step is writing out the fraction inside the log into separate components.
        The last step rewrites the integral into familiar components (KL divergence, likelihood and marginal
        likelihood).
        The marginal log-likelihood is over <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>Y</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">Y</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.22222em;">Y</span></span></span></span> instead of <span
            class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>X</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">X</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07847em;">X</span></span></span></span> as we saw in the VAE.
        To evaluate the likelihood, we use the fact that given the inducing points, the function values factorise:</p>
    <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing="">
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>Y</mi>
                                                <mi mathvariant="normal">∣</mi>
                                                <mi>U</mi>
                                                <mo separator="true">,</mo>
                                                <mi>F</mi>
                                                <mo stretchy="false">)</mo>
                                                <mo>=</mo>
                                                <munder>
                                                    <mo>∏</mo>
                                                    <mi>i</mi>
                                                </munder>
                                                <mi>p</mi>
                                                <mo stretchy="false">(</mo>
                                                <msub>
                                                    <mi>Y</mi>
                                                    <mi>i</mi>
                                                </msub>
                                                <mi mathvariant="normal">∣</mi>
                                                <msub>
                                                    <mi>F</mi>
                                                    <mi>i</mi>
                                                </msub>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                            </mtable>
                            <annotation encoding="application/x-tex">\begin{aligned}
                                p(Y|U, F) = \prod_i p(Y_i|F_i)
                                \end{aligned}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:2.6276740000000003em;vertical-align:-1.0638370000000001em;"></span><span
                            class="mord"><span class="mtable"><span class="col-align-r"><span
                                        class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist"
                                                style="height:1.5638370000000001em;"><span
                                                    style="top:-3.5638370000000004em;"><span class="pstrut"
                                                        style="height:3.0500050000000005em;"></span><span
                                                        class="mord"><span class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.22222em;">Y</span><span
                                                            class="mord">∣</span><span class="mord mathdefault"
                                                            style="margin-right:0.10903em;">U</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.13889em;">F</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mop op-limits"><span class="vlist-t vlist-t2"><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:1.0500050000000003em;"><span
                                                                            style="top:-1.872331em;margin-left:0em;"><span
                                                                                class="pstrut"
                                                                                style="height:3.05em;"></span><span
                                                                                class="sizing reset-size6 size3 mtight"><span
                                                                                    class="mord mathdefault mtight">i</span></span></span><span
                                                                            style="top:-3.050005em;"><span
                                                                                class="pstrut"
                                                                                style="height:3.05em;"></span><span><span
                                                                                    class="mop op-symbol large-op">∏</span></span></span></span><span
                                                                        class="vlist-s">​</span></span><span
                                                                    class="vlist-r"><span class="vlist"
                                                                        style="height:1.277669em;"><span></span></span></span></span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault">p</span><span
                                                            class="mopen">(</span><span class="mord"><span
                                                                class="mord mathdefault"
                                                                style="margin-right:0.22222em;">Y</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.31166399999999994em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mord">∣</span><span class="mord"><span
                                                                class="mord mathdefault"
                                                                style="margin-right:0.13889em;">F</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.31166399999999994em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mathdefault mtight">i</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mclose">)</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.0638370000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span>
    </p>
    <p>The approximate posterior <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>q</mi>
                            <mo stretchy="false">(</mo>
                            <mi>F</mi>
                            <mi mathvariant="normal">∣</mi>
                            <mi>U</mi>
                            <mo stretchy="false">)</mo>
                        </mrow>
                        <annotation encoding="application/x-tex">q(F|U)</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault"
                        style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span
                        class="mord mathdefault" style="margin-right:0.13889em;">F</span><span
                        class="mord">∣</span><span class="mord mathdefault"
                        style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span> is
        itself a Gaussian Process, with a mean and
        variance function that depend on the inducing variables.
        Following this <a href="https://www.prowler.io/blog/sparse-gps-approximate-the-posterior-not-the-model">blog</a>
        by James Hensman, we pick a particular mean and variance function for q (which we are free to do!), such that
        the ELBO is computable:</p>
    <p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math
                        xmlns="http://www.w3.org/1998/Math/MathML">
                        <semantics>
                            <mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em">
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mi>μ</mi>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>=</mo>
                                                <mi>K</mi>
                                                <mo stretchy="false">(</mo>
                                                <msub>
                                                    <mi>x</mi>
                                                    <mo>∗</mo>
                                                </msub>
                                                <mo separator="true">,</mo>
                                                <mi>Z</mi>
                                                <mo stretchy="false">)</mo>
                                                <mi>K</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>Z</mi>
                                                <mo separator="true">,</mo>
                                                <mi>Z</mi>
                                                <msup>
                                                    <mo stretchy="false">)</mo>
                                                    <mrow>
                                                        <mo>−</mo>
                                                        <mn>1</mn>
                                                    </mrow>
                                                </msup>
                                                <mi>m</mi>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                                <mtr>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mi>σ</mi>
                                                <mo stretchy="false">(</mo>
                                                <msub>
                                                    <mi>x</mi>
                                                    <mo>∗</mo>
                                                </msub>
                                                <mo separator="true">,</mo>
                                                <msub>
                                                    <mi>x</mi>
                                                    <mo>∗</mo>
                                                </msub>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                    <mtd>
                                        <mstyle scriptlevel="0" displaystyle="true">
                                            <mrow>
                                                <mrow></mrow>
                                                <mo>=</mo>
                                                <mi>k</mi>
                                                <mo stretchy="false">(</mo>
                                                <msub>
                                                    <mi>x</mi>
                                                    <mo>∗</mo>
                                                </msub>
                                                <mo separator="true">,</mo>
                                                <msub>
                                                    <mi>x</mi>
                                                    <mo>∗</mo>
                                                </msub>
                                                <mo stretchy="false">)</mo>
                                                <mo>−</mo>
                                                <mi>k</mi>
                                                <mo stretchy="false">(</mo>
                                                <msub>
                                                    <mi>x</mi>
                                                    <mo>∗</mo>
                                                </msub>
                                                <mo separator="true">,</mo>
                                                <mi>Z</mi>
                                                <mo stretchy="false">)</mo>
                                                <mrow>
                                                    <mo fence="true">[</mo>
                                                    <mi>k</mi>
                                                    <mo stretchy="false">(</mo>
                                                    <mi>Z</mi>
                                                    <mo separator="true">,</mo>
                                                    <mi>Z</mi>
                                                    <msup>
                                                        <mo stretchy="false">)</mo>
                                                        <mrow>
                                                            <mo>−</mo>
                                                            <mn>1</mn>
                                                        </mrow>
                                                    </msup>
                                                    <mo>−</mo>
                                                    <mi>k</mi>
                                                    <mo stretchy="false">(</mo>
                                                    <mi>Z</mi>
                                                    <mo separator="true">,</mo>
                                                    <mi>Z</mi>
                                                    <msup>
                                                        <mo stretchy="false">)</mo>
                                                        <mrow>
                                                            <mo>−</mo>
                                                            <mn>1</mn>
                                                        </mrow>
                                                    </msup>
                                                    <mi mathvariant="normal">Σ</mi>
                                                    <mi>k</mi>
                                                    <mo stretchy="false">(</mo>
                                                    <mi>Z</mi>
                                                    <mo separator="true">,</mo>
                                                    <mi>Z</mi>
                                                    <msup>
                                                        <mo stretchy="false">)</mo>
                                                        <mrow>
                                                            <mo>−</mo>
                                                            <mn>1</mn>
                                                        </mrow>
                                                    </msup>
                                                    <mo fence="true">]</mo>
                                                </mrow>
                                                <mi>k</mi>
                                                <mo stretchy="false">(</mo>
                                                <mi>Z</mi>
                                                <mo separator="true">,</mo>
                                                <msub>
                                                    <mi>x</mi>
                                                    <mo>∗</mo>
                                                </msub>
                                                <mo stretchy="false">)</mo>
                                            </mrow>
                                        </mstyle>
                                    </mtd>
                                </mtr>
                            </mtable>
                            <annotation encoding="application/x-tex">\begin{aligned}
                                \mu &amp;= K(x_*, Z)K(Z,Z)^{-1}m \\
                                \sigma(x_*, x_*) &amp;= k(x_*,x_*) - k(x_*, Z) \left[ k(Z,Z)^{-1} -k(Z,Z)^{-1} \Sigma
                                k(Z,Z)^{-1} \right ] k(Z, x_*)
                                \end{aligned}
                            </annotation>
                        </semantics>
                    </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                            style="height:3.048216em;vertical-align:-1.274108em;"></span><span class="mord"><span
                                class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span
                                            class="vlist-r"><span class="vlist" style="height:1.774108em;"><span
                                                    style="top:-3.91em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathdefault">μ</span></span></span><span
                                                    style="top:-2.385892em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.03588em;">σ</span><span
                                                            class="mopen">(</span><span class="mord"><span
                                                                class="mord mathdefault">x</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.175696em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mbin mtight">∗</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mord mathdefault">x</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.175696em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mbin mtight">∗</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mclose">)</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.274108em;"><span></span></span></span></span></span><span
                                    class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span
                                                class="vlist" style="height:1.774108em;"><span
                                                    style="top:-3.91em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">K</span><span
                                                            class="mopen">(</span><span class="mord"><span
                                                                class="mord mathdefault">x</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.175696em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mbin mtight">∗</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mclose">)</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">K</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mclose"><span class="mclose">)</span><span
                                                                class="msupsub"><span class="vlist-t"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.864108em;"><span
                                                                                style="top:-3.113em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mord mtight"><span
                                                                                            class="mord mtight">−</span><span
                                                                                            class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                                                            class="mord mathdefault">m</span></span></span><span
                                                    style="top:-2.385892em;"><span class="pstrut"
                                                        style="height:3em;"></span><span class="mord"><span
                                                            class="mord"></span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mrel">=</span><span class="mspace"
                                                            style="margin-right:0.2777777777777778em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.03148em;">k</span><span
                                                            class="mopen">(</span><span class="mord"><span
                                                                class="mord mathdefault">x</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.175696em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mbin mtight">∗</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mord mathdefault">x</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.175696em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mbin mtight">∗</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mbin">−</span><span class="mspace"
                                                            style="margin-right:0.2222222222222222em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.03148em;">k</span><span
                                                            class="mopen">(</span><span class="mord"><span
                                                                class="mord mathdefault">x</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.175696em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mbin mtight">∗</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mclose">)</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="minner"><span class="mopen delimcenter"
                                                                style="top:0em;"><span
                                                                    class="delimsizing size1">[</span></span><span
                                                                class="mord mathdefault"
                                                                style="margin-right:0.03148em;">k</span><span
                                                                class="mopen">(</span><span class="mord mathdefault"
                                                                style="margin-right:0.07153em;">Z</span><span
                                                                class="mpunct">,</span><span class="mspace"
                                                                style="margin-right:0.16666666666666666em;"></span><span
                                                                class="mord mathdefault"
                                                                style="margin-right:0.07153em;">Z</span><span
                                                                class="mclose"><span class="mclose">)</span><span
                                                                    class="msupsub"><span class="vlist-t"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.864108em;"><span
                                                                                    style="top:-3.113em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mtight">−</span><span
                                                                                                class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                                                                class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mbin">−</span><span class="mspace"
                                                                style="margin-right:0.2222222222222222em;"></span><span
                                                                class="mord mathdefault"
                                                                style="margin-right:0.03148em;">k</span><span
                                                                class="mopen">(</span><span class="mord mathdefault"
                                                                style="margin-right:0.07153em;">Z</span><span
                                                                class="mpunct">,</span><span class="mspace"
                                                                style="margin-right:0.16666666666666666em;"></span><span
                                                                class="mord mathdefault"
                                                                style="margin-right:0.07153em;">Z</span><span
                                                                class="mclose"><span class="mclose">)</span><span
                                                                    class="msupsub"><span class="vlist-t"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.864108em;"><span
                                                                                    style="top:-3.113em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mtight">−</span><span
                                                                                                class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                                                                class="mord">Σ</span><span class="mord mathdefault"
                                                                style="margin-right:0.03148em;">k</span><span
                                                                class="mopen">(</span><span class="mord mathdefault"
                                                                style="margin-right:0.07153em;">Z</span><span
                                                                class="mpunct">,</span><span class="mspace"
                                                                style="margin-right:0.16666666666666666em;"></span><span
                                                                class="mord mathdefault"
                                                                style="margin-right:0.07153em;">Z</span><span
                                                                class="mclose"><span class="mclose">)</span><span
                                                                    class="msupsub"><span class="vlist-t"><span
                                                                            class="vlist-r"><span class="vlist"
                                                                                style="height:0.864108em;"><span
                                                                                    style="top:-3.113em;margin-right:0.05em;"><span
                                                                                        class="pstrut"
                                                                                        style="height:2.7em;"></span><span
                                                                                        class="sizing reset-size6 size3 mtight"><span
                                                                                            class="mord mtight"><span
                                                                                                class="mord mtight">−</span><span
                                                                                                class="mord mtight">1</span></span></span></span></span></span></span></span></span><span
                                                                class="mclose delimcenter" style="top:0em;"><span
                                                                    class="delimsizing size1">]</span></span></span><span
                                                            class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord mathdefault"
                                                            style="margin-right:0.03148em;">k</span><span
                                                            class="mopen">(</span><span class="mord mathdefault"
                                                            style="margin-right:0.07153em;">Z</span><span
                                                            class="mpunct">,</span><span class="mspace"
                                                            style="margin-right:0.16666666666666666em;"></span><span
                                                            class="mord"><span class="mord mathdefault">x</span><span
                                                                class="msupsub"><span class="vlist-t vlist-t2"><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.175696em;"><span
                                                                                style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span
                                                                                    class="pstrut"
                                                                                    style="height:2.7em;"></span><span
                                                                                    class="sizing reset-size6 size3 mtight"><span
                                                                                        class="mbin mtight">∗</span></span></span></span><span
                                                                            class="vlist-s">​</span></span><span
                                                                        class="vlist-r"><span class="vlist"
                                                                            style="height:0.15em;"><span></span></span></span></span></span></span><span
                                                            class="mclose">)</span></span></span></span><span
                                                class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist"
                                                style="height:1.274108em;"><span></span></span></span></span></span></span></span></span></span></span></span>
    </p>
    <p>This step might seem abstract, but it's common in variational inference to pick <span class="katex"><span
                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>q</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">q</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault"
                        style="margin-right:0.03588em;">q</span></span></span></span> such that the ELBO becomes
        tractable.
        The more flexible <span class="katex"><span class="katex-mathml"><math
                    xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>q</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">q</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault"
                        style="margin-right:0.03588em;">q</span></span></span></span> we allow, the better it can
        approximate the true posterior.
        <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>m</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">m</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.43056em;vertical-align:0em;"></span><span
                        class="mord mathdefault">m</span></span></span></span>, <span class="katex"><span
                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi mathvariant="normal">Σ</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">\Sigma</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span
                        class="mord">Σ</span></span></span></span>, and <span class="katex"><span
                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>Z</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">Z</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span></span></span></span> are all variational parameters
        that can be optimised through gradient descent.
        Interestingly, this means that the inducing points themselves, <span class="katex"><span
                class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML">
                    <semantics>
                        <mrow>
                            <mi>Z</mi>
                        </mrow>
                        <annotation encoding="application/x-tex">Z</annotation>
                    </semantics>
                </math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut"
                        style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault"
                        style="margin-right:0.07153em;">Z</span></span></span></span>, have become part of the
        objective.
        This is different way of thinking than in the VAE, where we only care about updating the parameters of the deep
        network.
        For a detailed derivation, see also <a href="https://arxiv.org/abs/1402.1412">this tutorial</a> by Yarin Gal and
        Mark van der Wilk.
    </p>
    <h2 id="conclusion">Conclusion</h2>
    <p>In this blog I have shown that performing variational inference in VAEs and GPs is very similar.
        In both cases we start out with an intractable equation and introduce a new distribution to create a tractable
        approximation.
        We try to find the best approximation to the original problem (or alternatively minimise the KL divergence!).
    </p>
    <p>If you found this interesting and are curious to find out more about GPs, then there is a considerable amount of
        literature available.
        I can recommend the <a href="http://proceedings.mlr.press/v31/damianou13a.pdf">deep GP</a> paper and <a
            href="http://papers.nips.cc/paper/7045-doubly-stochastic-variational-inference-for-deep-gaussian-processes">variational
            extensions</a> of it.</p>
    <p>Lastly I would like to bring your attention to my own work, which combines the benefits of GPs with the
        flexibility of deep learning: <a href="https://openreview.net/pdf?id=8W7LTo_zxdE">vDUQ</a>.
        vDUQ is an instance of Deep Kernel Learning and uses the inducing point approximation we discussed above!
        Interestingly, the inducing points are placed in the <em>feature space</em> of a deep neural network, allowing
        only a handful of inducing points to be used for complicated datasets such as CIFAR-10.</p>

</body>

</html>
